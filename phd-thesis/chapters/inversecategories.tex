%!TEX root = /Users/gilesb/UofC/thesis/phd-thesis/phd-thesis.tex
\chapter{Inverse categories} % (fold)
\label{cha:inverse_categories}
\section{Inverse products} % (fold)
\label{sec:inverse_products}

This chapter is focussed on adding ``products'' to an inverse category.

We will show below that inverse category that has a
restriction product is a restriction preorder. Given this, by ``product'', we mean a construction
that behaves in a product-like manner in an inverse category. We call \emph{inverse products}, which
will be defined below in sub-section~\ref{sub:inverse_products}.
Inverse products are given by a tensor product which supports a diagonal but lacks projections. The
diagonal map is required to give a natural Frobenius structure to each object.

\subsection{Inverse categories with restriction products} % (fold)
\label{sub:inverse_categories_with_restriction_products}
We start by showing that an inverse category with restriction products is a restriction preorder.

\begin{definition}\label{def:compatible_maps}
  Two parallel maps $f,g:A \to B$ in a restriction category are \emph{compatible}, written as $f
  \smile g$, when $\rst{f} g = \rst{g} f$.
\end{definition}
\begin{definition}\label{def:restrictionpreorder}
  A restriction category \X is a \emph{restriction preorder} when all parallel pairs of maps are
  compatible.
\end{definition}
\begin{lemma}\label{lem:an_inverse_category_with_products_is_a_restriction_preorder}
  Given an inverse category \X, if it has restriction products, it is a restriction preorder. That
  is,
  \[
    \xymatrix {
      A  \ar@<1ex>[r]^{f} \ar@<-1ex>[r]_{g} &B
    }
    \implies f \smile g.
  \]
\end{lemma}
\begin{proof}
  Notice,
  \begin{align*}
    \inv{\pi_1} & = \Delta \pi_1 \inv{\pi_1}\\
    &=\Delta \restr{\pi_1}\\
    &=\Delta.
  \end{align*}
  This gives $\restr{\inv{\pi_1}} = 1$ and therefore $\pi_1$ (and similarly, $\pi_0$) is an
  isomorphism.

  Starting with the product map $\<f,g\>$,
  \[
    \infer={\restr{f}g = \restr{g}f}
    {\infer={\restr{f}g\Delta = \restr{g}f\Delta}
    {\infer={\restr{f}g\inv{\pi_1} = \restr{g}f\inv{\pi_0}}
    {\infer={\<f,g\>\pi_1 \inv{\pi_1} = \<f,g\>\pi_0 \inv{\pi_0}}
    {\<f,g\> = \<f,g\>}}}}
  \]
  which shows that $f$ and $g$ are compatible.
\end{proof}

\begin{corollary}
  \X\ is a Cartesian inverse category if and only if Total($\spl{r}{\X}$) is a meet preorder.
\end{corollary}

\begin{proof}
  Total(\X), the subcategory of total maps on \X, has products and therefore every pair of parallel
  maps is compatible. As total compatible maps are equal, there is at most
  one map between any two objects. Hence, Total(\X) is a preorder with the meet being the product.

  Similarly, from \cite{cockett2002:restcategories1} and \cite{cockettlack2004:restcategories3},
  Total($\spl{r}{\X}$) is an inverse category and has products and is therefore also a meet
  preorder. This shows the ``only if'' side of the corollary.

  For the other direction, if Total($\spl{r}{\X}$) is a meet preorder, define the product as the
  meet of the maps and the terminal object as the supremum of all maps.
\end{proof}

\begin{corollary}
  Every Cartesian inverse category is a full subcategory of a partial map category of a meet
  semi-lattice.
\end{corollary}


% subsection inverse_categories_with_restriction_products (end)

\subsection{Inverse products} % (fold)
\label{sub:inverse_products}

\begin{definition}\label{def:inverse_product_tensor}
  Given a restriction category \X, a tensor $\*$ is called an \emph{inverse product tensor}
  when:
\begin{itemize}
  \item $\*$ is a restriction functor, $\_ \* \_ : \X \times \X \to \X$.
  \item $\*$ is a symmetric monoidal tensor satisfying the standard symmetric monoidal equations and
    coherence diagrams hold (see, e.g., \cite{maclan97:categorieswrkmath}) and has the following
    natural isomorphisms:
    \begin{align*}
      1 &: \boldsymbol{1}\to \X \\
      \usl &: 1 \* A \xrightarrow{\cong} A
      &\usr &: A \* 1 \xrightarrow{\cong} A\\
      a_{\*} &: (A \* B) \* C \xrightarrow{\cong} A \* (B \* C)
      &c_{\*} &: A \* B \xrightarrow{\cong} B \* A.
    \end{align*}
  \end{itemize}
  Note that as all the coherence maps are isomorphisms, they are total.
\end{definition}

\begin{definition}\label{def:inverse_product}
  An \emph{inverse product} on an invese category \X is given by an inverse product tensor $\*$
  together with a  natural ``Frobenius'' diagonal map, $\Delta$. Additionally, we define the
  map $\excs: (A\*B)\*(C\*D) \to (A\*C) \* (B\*D)$:
  \[
    \excs =  a_{\*}(1\*\inv{a_{\*}})(1\*(c_{\*}\*1))(1\* a_{\*})\inv{a_{\*}}).
  \]

  The diagonal map $\Delta_A:A \to A\*A$ must be total and satisfy the following:
  \[
    \xymatrix @!0 @C=90pt @R=35pt{
      A \ar[dr]_{\Delta} \ar[r]^{\Delta} &
      A \* A \ar[d]^{c_{\*}}\\
      & A \* A\\
      &*!<3pc,-15pt>{\text{\textbf{Co-commutative}}}
    }
  \]
  \[
    \xymatrix @C=30pt @R=30pt{
      A \ar[rr]^{\Delta} \ar[d]_{\Delta} & &
      A \* A \ar[d]^{1\*\Delta}\\
      A\*A \ar[dr]_{\Delta \* 1}& & A \* ( A \* A) \\
      &   (A \* A) \* A \ar[ur]_{a_{\*}}\\
      &*!<0pc,-35pt>{\text{\textbf{Co-associative}}}
    }
  \]
  \[
    \xymatrix @C=40pt @R=35pt{
      A \* B \ar[d]_{\Delta}
      \ar[rr]^{\Delta \* \Delta} & &
      (A \* A) \* (B \* B) \ar[d]^{\excs}\\
      (A \* B) \* (A \* B) \ar@{=}[rr] & &
      (A \* B) \* (A \* B)\\
      &*!<0pc,-25pt>{\text{\textbf{Exchange}}}
    }
  \]

  \[
    \xymatrix @C=40pt @R=25pt{
      A \* A \ar[dd]_{(1\*\Delta) \inv{a_{\*}}} \ar[dr]^{\inv{\Delta}}
      \ar[rr]^{(\Delta \* 1) a_{\*}} & &
      A \* (A \* A) \ar[dd]^{1 \* \inv{\Delta}}\\
      & A \ar[dr]^{\Delta} & \\
      (A \* A) \* A \ar[rr]_{\inv{\Delta} \* 1} & &
      A \* A\\
      &*!<0pc,-25pt>{\text{\textbf{Frobenius}}}
    }
  \]
  Thus, $\Delta$ is a co-commutative, coassociative map which together with $\inv{\Delta}$ forms a
  Frobenius algebra.
\end{definition}

\begin{remark}
  Note also, co-commutativity implies that $c_{\*}\inv{\Delta} = \inv{\Delta}$.
  One can see this as:
  \begin{align*}
    \Delta(c_{\*}\inv{\Delta})
      &= (\Delta c_{\*})\inv{\Delta} = \Delta\inv{\Delta} = \rst{\Delta} \text{ and}\\
    (c_{\*}\inv{\Delta})\Delta
      & = (c_{\*}\inv{\Delta})(\Delta c_{\*}) = \rst{c_{\*}\inv{\Delta}}.
  \end{align*}
  This means that both $\inv{\Delta}$ and $c_{\*}\inv{\Delta}$ are partial inverses for $\Delta$
  and are therefore equal.

  Similarly, one can show that $(\inv{\Delta}\* 1)\inv{\Delta} =
  a_{\*}(\inv{\Delta}\* 1)\inv{\Delta}$.
\end{remark}
% \subsubsection{Diagrammatic language} % (fold)
% \label{ssub:diagrammatic_language}

% \begin{tikzpicture}[scale=.3]
%   \draw (2,1) -- (2,0);
%   \draw (2,0) -- (1.25,-1.2) -- (2.75,-1.2) -- cycle;
%   \draw (1.5,-1.2) -- (1.5,-2.5);
%   \draw (2.5,-1.2) -- (2.5,-2.5);

%   \node at (3.3,-1.3) {$=$};

%   \draw (5,1) -- (5,0);
%   \draw (5,0) -- (4.25,-1.2) -- (5.75,-1.2) -- cycle;
%   \draw (4.5,-1.2) .. controls (4.9,-2.5) and (5.1, -1.2) .. (5.5,-2.5);
%   \draw (5.5,-1.2)  .. controls (5.1,-2.5) and (4.9, -1.2) .. (4.5,-2.5);
% \end{tikzpicture}
% % subsubsection diagrammatic_language (end)


Inverse products are extra structure on an inverse category, rather than a property. A concrete
category showing this is given in the following example.

\begin{example}[Showing that inverse product is additional structure]
  \label{example:invprodisstructure}
\end{example}
Any discrete category (i.e., a category with only the identity arrows) is a trivial inverse
category. To create an inverse product on a discrete category, add a commutative, associative,
idempotent multiplication, with a unit.

Let $\D$ be the discrete category of four objects and label them as $a,b,c$ and $d$. Then, define
two different inverse product tensors, $\*$ and $\odot$ by:
\begin{quote}
  \qquad\qquad
  \begin{tabular}{|l||c|c|c|c|}
    \hline
    $\*$&a&b&c&d\\ \hline \hline
    a&a&a&a&a\\ \hline
    b&a&b&\textbf{b}&b\\ \hline
    c&a&\textbf{b}&c&c \\ \hline
    d&a&b&c&d \\ \hline
  \end{tabular}
  \hfil
  \begin{tabular}{|l||c|c|c|c|}
    \hline
    $\odot$&a&b&c&d\\ \hline \hline
    a&a&a&a&a\\ \hline
    b&a&b&\textbf{a}&b\\ \hline
    c&a&\textbf{a}&c&c \\ \hline
    d&a&b&c&d \\ \hline
  \end{tabular}
  \qquad \qquad
\end{quote}

As $\D$ is discrete, $\Delta$ is forced to be the identity. By inspection, we can see each of
the conditions for $\Delta$ are satisfied by $\*$ and by $\odot$.

% subsection inverse_products (end)
\subsection{Diagrammatic Language} % (fold)
\label{sub:diagrammatic_language}

While it is certainly possible to prove results about inverse products using direct algebraic
manipulation, it is much more succinct to proceed with string diagrams. As shown in
\cite{street-ross-1991-GTC-I} this is equivalent to reasoning algebraically for symmetric monoidal
categories.

In the diagrams, we will use the following representations:
\begin{itemize}
  \item $\Delta$ will be represented by an upward pointing triangle: \begin{tikzpicture}
      \path node [delta] at (0,0) {}; \end{tikzpicture}.
  \item $\inv{\Delta}$ by a downward triangle: \begin{tikzpicture}
      \path node [nabla] at (0,0) {}; \end{tikzpicture}.
  \item maps by a rectangle with the map inside: \begin{tikzpicture}
      \path node [map] at (0,0) {$f$}; \end{tikzpicture}.
  \item unit introduction (often referred to as an $\eta$ map): \begin{tikzpicture}
      \path node [eta] at (0,0) {}; \end{tikzpicture}.
  \item unit removaln (often referred to as an $\epsilon$ map): \begin{tikzpicture}
      \path node [epsilon] at (0,0) {}; \end{tikzpicture}.
\end{itemize}

% end sub:diagrammatic_language


\subsection{Discrete inverse categories} % (fold)
\label{sub:discrete_inverse_categories}

\begin{definition}\label{def:discrete_inverse_category}
  If an inverse category has inverse products as in Definition~\ref{def:inverse_product}, we call it
  a \emph{discrete inverse category}.
\end{definition}

This sub-section will present some properties of discrete inverse categories. This sub-section will
form the basis for our eventual goal, that of connecting discrete inverse categories to Cartesian
restriction categories. This connection will be given as a functor that lifts an inverse category to
a Cartesian restriction category.

\begin{lemma}\label{lem:properties_of_delta_and_tensor_in_a_discrete_inverse_category}
  In a discrete inverse category \X with the inverse product $\*$ and $\Delta$, where
  $e=\rst{e}$ is a restriction idempotent and $f,g,h$ are arrows in \X, the following are true:
  \begin{enumerate}[{(}i{)}]
    \item{}$e=\Delta (e\* 1) \inv{\Delta}$.\label{le:eisde1}
    \item{}$e\Delta (f \* g) = \Delta (e f \* g) $ (and $= \Delta (f \* e g) $ and
      $ = \Delta (e f \* e g)$.)\label{le:deltaefg}
    \item{}$ (f \* g e) \inv{\Delta} =(f \* g) \inv{\Delta} e $ (and $= (f e\* g) \inv{\Delta}$ and
      $ = (f e\* g e)\inv{\Delta}$.)\label{le:efginvdelta}
    \item{}$\restr{\Delta (f \* g) \inv{\Delta}} =
       \Delta(1\* g \inv{f})\inv{\Delta}$. \label{le:restfg}
    \item{} If $\Delta (h \* g) \inv{\Delta} = \restr{\Delta (h \* g) \inv{\Delta}}$ then
      $(\Delta (h \* g) \inv{\Delta}) h = \Delta (h \* g) \inv{\Delta}$.\label{le:hge}
    \item{}$\Delta (f\*1) = \Delta (g\*1) \implies f = g$.\label{le:dfgisfg}
    \item{}$(f\*1) = (g\*1) \implies f = g$.\label{le:fgisfg}
  \end{enumerate}
\end{lemma}
\begin{proof}
  \prepprooflist
  \begin{enumerate}[{(}i{)}]
    \item[\ref{le:eisde1}]This is shown by proving both sides
      equal $\Delta (e\* 1) \inv{\Delta} \Delta (e\* 1) \inv{\Delta}$.
      \begin{align*}
        \Delta (e\* 1) &\inv{\Delta} \Delta (e\* 1) \inv{\Delta} \\
        &= \Delta (e\* 1) \inv{\Delta} \Delta (1\* e) \inv{\Delta}&\text{co-commutativity}\\
        &=\Delta(e \Delta \* 1) (1\*\inv{\Delta} e) \inv{\Delta} &\text{Frobenius}\\
        &=\Delta(\Delta \* 1) (e\*e\*1) (1\*\inv{\Delta}e)\inv{\Delta}&\Delta\text{natural}\\
        &=\Delta(\Delta \* 1) (e\*e\*1) \\
          & \qquad(1\*e\*e)(1\*\inv{\Delta})\inv{\Delta}&\inv{\Delta}\text{ natural}\\
        &=\Delta (\Delta \*1) (e\* e\* e)(1\* \inv{\Delta})\inv{\Delta}&e\text{ idempotent}\\
        &=\Delta (\Delta \*1) (e\* \inv{\Delta}e)\inv{\Delta}&\inv{\Delta}\text{ natural}\\
        &=\Delta (\Delta \*1) (1\* \inv{\Delta})\inv{\Delta}e&\inv{\Delta}\text{ natural}\\
        &=\Delta \inv{\Delta}\Delta \inv{\Delta}e&\text{Frobenius}\\
        &=e&\Delta\text{ total}.
      \end{align*}
      At the same time,
      \begin{align*}
        \Delta (e\* 1) &\inv{\Delta} \Delta (e\* 1) \inv{\Delta}
        =\Delta(e \Delta \* 1) (e\*\inv{\Delta} 1) \inv{\Delta} &\text{Frobenius}\\
        &=\Delta(\Delta \* 1) (e\*e\*1) (e\*\inv{\Delta})\inv{\Delta}&\Delta\text{natural}\\
        &=\Delta(\Delta \* 1) (e\*e\*1) (e\*1\*1)(1\*\inv{\Delta})\inv{\Delta}&\inv{\Delta}\text{ natural}\\
        &=\Delta (\Delta \*1) (e\* e\* 1)(1\* \inv{\Delta})\inv{\Delta}&e\text{ idempotent}\\
        &=\Delta  (e\Delta\* 1)(1\*\inv{\Delta})\inv{\Delta}&\Delta\text{natural}\\
        &=\Delta (e \* 1) \inv{\Delta}\Delta\inv{\Delta} &\text{Frobenius}\\
        &=\Delta (e \* 1) \inv{\Delta} &\Delta\text{ total}\
      \end{align*}
      which gives $e = \Delta (e \* 1) \inv{\Delta}$.
    \item[\ref{le:deltaefg}]This equality starts by using the previous equality:
      \begin{align*}
        e\Delta &(f \* g) = \Delta (e\* 1) \inv{\Delta} \Delta(f \* g)
          &\text{by part \ref{le:eisde1}}\\
        &=\Delta(e  \* 1) \rst{\inv{\Delta}}(f\*g)&\\
        &=\Delta\rst{\inv{\Delta}}(e \*1)(f\*g)
          & \text{\rtwo}\\
        &=\Delta (e f \* g) &\text{ ($f\inv{f} = f$)}.
      \end{align*}
      The second and third equalities follow by co-commutativity and naturality of $\Delta$ and $e$
      being a restriction idempotent.
    \item[\ref{le:efginvdelta}] As in (\ref{le:deltaefg}), details are only given for the
      first equality.
      \begin{align*}
        (f \* g)&\inv{\Delta} e \\
        &= (f \* g) \inv{\Delta}\Delta (1\*e) \inv{\Delta}   &\text{part \ref{le:eisde1}}\\
        &=(f\*g)\rst{\inv{\Delta}}(1\*e) \inv{\Delta}&\\
        &=(f\*g)(1\*e) \rst{\inv{\Delta}}\inv{\Delta}&\rtwo\\
        &=(f\*g e)\inv{\Delta}&\rone
      \end{align*}
      The other equalities follow from co-commutativity and naturality of $\Delta$ and $e$ being
      a restriction idempotent.
    \item[\ref{le:restfg}]Here, we start by using the fact all maps have a partial inverse:
      \begin{align*}
        ~&\restr{\Delta (f \* g) \inv{\Delta} } \\
        &=\Delta (f \* g) \inv{\Delta} \Delta (\inv{f} \* \inv{g}) \inv{\Delta} \\
        &=\Delta (g \* f) \inv{\Delta} \Delta (\inv{g} \* \inv{f}) \inv{\Delta}& \text{co-commutative} \\
        &=\Delta(g\Delta \*f)(\inv{g}\*\inv{\Delta}\inv{f})\inv{\Delta}&\text{Frobenius}\\
        &=\Delta (\Delta\*1)(g \* g \* f)(\inv{g}\*\inv{\Delta}\inv{f})\inv{\Delta}&\Delta \text{ natural}\\
        &=\Delta (\Delta\*1)(g \* g \* f)\\
          &\qquad(\inv{g} \* \inv{f}\* \inv{f})(1\* \inv{\Delta})\inv{\Delta}&\inv{\Delta} \text{ natural}\\
        &=\Delta (\Delta\*1)(\restr{g} \* g \inv{f}\* \restr{f})(1\* \inv{\Delta})\inv{\Delta}&\text{combine maps}\\
        &=\Delta (\Delta\*1)(\restr{g} \* \restr{g}\,g \inv{f}\restr{f}\* \restr{f})(1\* \inv{\Delta})\inv{\Delta}&\text{restriction axioms}\\
        &=\Delta (\restr{g}\Delta\*1)(1\*g\inv{f}\restr{f}\* \restr{f})(1\*\inv{\Delta}) \inv{\Delta}&\Delta \text{ natural}\\
        &=\Delta (\restr{g}\Delta\*1)(1\*g\inv{f}\*1)(1\*\inv{\Delta}\restr{f}) \inv{\Delta}&\inv{\Delta} \text{ natural}\\
        &=\Delta (\Delta\*1)(1 \* \restr{g}g \inv{f}\*1)(1\*\inv{\Delta}\restr{f}) \inv{\Delta}&\text{This lemma(\ref{le:deltaefg})}\\
        &=\Delta (\Delta\*1)(1 \* \restr{g}g \inv{f}\restr{f}\*1)(1\*\inv{\Delta}) \inv{\Delta}&\text{This lemma(\ref{le:efginvdelta})}\\
        &=\Delta (\Delta\*1)(1 \*g \inv{f}\*1)(1\*\inv{\Delta}) \inv{\Delta}&\text{restriction axioms}\\
        &=\Delta c_{A,A}(\Delta\*1)(1 \*g \inv{f}\*1)(1\*\inv{\Delta}) \inv{\Delta}&\text{co-commutative}\\
        &=\Delta (1\*\Delta)c_{A,A\*A}(1 \*g \inv{f}\*1)(1\*\inv{\Delta}) \inv{\Delta}&c_{\*}\text{natural}\\
        &=\Delta (1\*\Delta)(1\*1\*g \inv{f})c_{A,A\*A}(1\*\inv{\Delta}) \inv{\Delta}&c_{\*}\text{natural}\\
        &=\Delta (1\*\Delta)(1\*1\*g \inv{f})(\inv{\Delta}\*1)c_{A,A} \inv{\Delta}&c_{\*}\text{natural}\\
        &=\Delta (1\*\Delta)(1\*1\*g \inv{f})(\inv{\Delta}\*1) \inv{\Delta}&c_{\*}\text{co-commutative}\\
        &=\Delta \inv{\Delta}\Delta (1 \* g \inv{f})\inv{\Delta}&\text{Frobenius}\\
        &=\Delta(1 \* g \inv{f}) \inv{\Delta}&\Delta\text{ total}
      \end{align*}
      Note the pattern in the last few lines of using the co-commutativity of $\Delta$, the
      naturality of the commutativity isomorphism and finishing with the co-commutativity of
      $\inv{\Delta}$. In future proofs, these steps will be combined to a single line and referred to
      as commutativity.
    \item[\ref{le:hge}]Beginning with the assumption,
      \begin{align*}
        (\Delta &(h \* g)\inv{\Delta})h  = \rst{\Delta (h \* g) \inv{\Delta}}h&\\
        &=\Delta(1 \* g \inv{h}) \inv{\Delta}h&\text{This lemma(\ref{le:restfg})}\\
        &=\Delta(1 \* g \inv{h}) \inv{\Delta}\Delta(h\*h)\inv{\Delta}&\Delta\text{ total and natural}\\
        &=\Delta(1 \* g \inv{h}) (\Delta \* 1)(1\*\inv{\Delta})(h\*h)\inv{\Delta}&\text{Frobenius}\\
        &=\Delta(\Delta\*1)(1\*1\*g\inv{h})\\
          &\qquad(1\*\inv{\Delta}) (h\*h)\inv{\Delta}&\Delta \text{ natural}\\
        &=\Delta(\Delta\*1)(1\*1\*g\inv{h})\\
          &\qquad(h\*h\*h)(1\*\inv{\Delta}) \inv{\Delta}&\inv{\Delta}\text{ natural}\\
        &=\Delta(\Delta\*1)(h\*h\*g\inv{h}h)\\
        &\qquad(1\*\inv{\Delta}) \inv{\Delta}&\text{combine terms}\\
        &=\Delta(h\*g\restr{\inv{h}})(\Delta\*1)(1\*\inv{\Delta})\inv{\Delta} &\Delta \text{ natural}\\
        &=\Delta(h\*g\restr{\inv{h}})\inv{\Delta}\Delta\inv{\Delta} &\text{Frobenius}\\
        &=\Delta(h \* g \restr{\inv{h}})\inv{\Delta}&\Delta \text{ total}\\
        &=\Delta(h \* g )\inv{\Delta}\restr{\inv{h}}& \text{part (\ref{le:deltaefg})}\\
        &=\Delta(h\restr{\inv{h}}\*g)\inv{\Delta}&\text{part (\ref{le:deltaefg})}\\
        &=\Delta(h\*g)\inv{\Delta}&\text{property of inverse}.
      \end{align*}

    \item[\ref{le:dfgisfg}]As $\Delta$ is total and natural, we start with:
      \begin{align*}
        f&=\Delta(f\*f)\inv{\Delta}  & \\
        &= \Delta(f\*1)(1\*f)\inv{\Delta} &  \\
        &= \Delta(g\*1)(1\*f)\inv{\Delta} &\text{assumption} \\
        &= \Delta(1\*f)(g\*1)\inv{\Delta} &\text{Identities commute}\\
        &= \Delta(1\*g)(g\*1)\inv{\Delta} &\text{assumption, co-commutative}\\
        &= \Delta(g\*g)\inv{\Delta} \\
        &= g\Delta\inv{\Delta} & \Delta \text{ natural}\\
        &= g&\Delta\text{ total}.
      \end{align*}
    \item[\ref{le:fgisfg}] Immediate from part \ref{le:dfgisfg}.
  \end{enumerate}
\end{proof}

\begin{proposition}
  A discrete inverse category has meets, where $f\cap g =\Delta (f\* g) \inv{\Delta}$.
\end{proposition}
\begin{proof}
  $f\cap g \le f$:
  \begin{align*}
    f\cap g&= \Delta (f\*g) \inv{\Delta}&\text{Definition of }\cap \\
    &= \Delta (f\restr{\inv{f}}\*g) \inv{\Delta} &\text{property of inverse}\\
    &= \Delta (f \* g\restr{\inv{f}}) \inv{\Delta} &\text{by lemma \ref{lem:properties_of_delta_and_tensor_in_a_discrete_inverse_category}(\ref{le:efginvdelta})}\\
    &= \Delta (f \* g\inv{f}f) \inv{\Delta} &\text{definition of inverse}\\
    &= \Delta (1 \* g\inv{f}) \inv{\Delta} f &\inv{\Delta}\text{ natural}\\
    &=\restr{f \cap g} f &\text{by lemma \ref{lem:properties_of_delta_and_tensor_in_a_discrete_inverse_category}(\ref{le:restfg})}\\
  \end{align*}

  $f\cap f = f$:
  \begin{align*}
    f\cap f &= \Delta(f\* f) \inv{\Delta}\\
    &=f \Delta \inv{\Delta} &\Delta\text{ natural}\\
    &= f&\Delta\text{ total}.
  \end{align*}

  $h(f\cap g) = h f \cap hg$:
  \begin{align*}
    h(f\cap g) &= h \Delta(f\* g) \inv{\Delta}& \text{Definition of }\cap\\
    &= \Delta(h \* h) (f \* g) \inv{\Delta} &\Delta\text{ natural}\\
    &= \Delta(h f\* hg) \inv{\Delta} &\text{compose maps}\\
    &= h f \cap hg&\text{Definition of }\cap.
  \end{align*}
\end{proof}
% subsection discrete_inverse_categories (end)


\subsection{The inverse subcategory of a discrete restriction category } % (fold)
\label{sub:the_inverse_subcategory_of_a_discrete_restriction_category}

Given a discrete restriction category, one can pick out the maps which are partial isomorphisms.
Using results from the previous sub-section and from sub-section~\ref{sub:discrete_categories},
this section will show that these maps form a restriction subcategory and in fact form a discrete
inverse category.

\begin{proposition}\label{lem:inv_x_is_a_discrete_inverse_category}
  Given \X is a discrete restriction category, the invertible maps of \X, together with the objects
  of \X form a sub-restriction category which is a discrete inverse category. For the restriction
  category $\X$, we denote this sub-category by \Invc{\X}.
\end{proposition}
\begin{proof}
  As shown in Lemma~\ref{lem:rcs_partial_monic_section_inverse_properties}, partial isomorphisms
  are closed under composition. The identity maps are in \Invc{\X} and restrictions of
  partial isomorphisms are also partial isomorphisms.

  The product on the discrete restriction category \X becomes the tensor product of the restriction
  category \Invc{\X}. Table~\ref{tab:structural_maps_for_the_tensor_in_invx} shows how each of the
  elements of the tensor are defined. Note that the last definition makes explicit use of the fact
  we are in a discrete restriction category and hence the $\Delta$ of \X possesses a partial
  inverse.

  \begin{table}[h!]
    \begin{center}
      \begin{tabular}{|ccc|}
        \hline
        \X & \Invc{\X} & Inverse map\\
        \hline\hline
        $\scriptstyle A\times B$ & $\scriptstyle A\* B$ &\\
        \hline
        $\scriptstyle \top$ & $\scriptstyle 1$ &\\
        \hline
        $\scriptstyle \pi_1:\top\times A \to A$ & $\scriptstyle \usl:1\* A \to A$ & $\scriptstyle \<!,1\>$\\
        \hline
        $\scriptstyle \pi_0:A\times\top \to A$ & $\scriptstyle \usr:A\*1 \to A$& $\scriptstyle \<1,!\>$\\
        \hline
        ${\scriptstyle \<\pi_0 \pi_0,\<\pi_0 \pi_1,\pi_1\>\>:(A\times B)\times C \to A\times(B\times C)}$
          & $\scriptstyle a_{\*}:(A\*B)\*C \to A\*(B\*C)$
          & $\scriptstyle \<\<\pi_0, \pi_1 \pi_0\>,\pi_1 \pi_1\>$\\
        \hline
        $\scriptstyle \< \pi_1,\pi_0\>:A\times B \to B\times A$ & $\scriptstyle c_{\*}:A\*B \to B \* A$ & $\scriptstyle \< \pi_1,\pi_0\>$\\
        \hline
        $\scriptstyle \Delta_{\X}:A\to A\times A$ & $\scriptstyle \Delta:A \to A\* A$ & $\scriptstyle  \inv{\Delta_{\X}} $\\
        \hline
      \end{tabular}

    \end{center}
    \caption{Structural maps for the tensor in \Invc{\X}}
    \label{tab:structural_maps_for_the_tensor_in_invx}
  \end{table}

  The monoid coherence diagrams follow directly from the characteristics of the product in
  \X. Similarly, $\Delta$ is total as it is total in $\X$. It remains to show co-commutativity,
  co-associativity and the Frobenius condition.

  Co-commutativity requires $\Delta c_{\*} = c_{\*}$. This means we need
  \[\Delta_{\X} \< \pi_1,\pi_0\> = \Delta_{\X}.\] Once again, this follows immediately from the
  definition of the restriction product.

  Co-associativity requires $\Delta (1 \* \Delta) = \Delta (\Delta \* 1) a_{\*}$. Expressing this
  in \X, we require
  \[
    \Delta_{\X} (1 \times \Delta_{\X}) =
      \Delta_{\X}(\Delta_{\X} \times 1) (\<\pi_0 \pi_0,\<\pi_0 \pi_1,\pi_1\>\>).
  \]
  Again each is equal based on the properties of the restriction product.

  The Frobenius requirement is two-fold:
  \begin{align}
    \inv{\Delta} \Delta &= (\Delta \*1) a_{\*}(1\*\inv{\Delta}) \label{eq:frobenius_righths_need_in_invx}\\
    \inv{\Delta} \Delta &= (1 \* \Delta) \inv{a_{\*}}(\inv{\Delta}\* 1), \label{eq:frobenius_lefths_need_in_invx}.
  \end{align}
  In \X, this becomes:
  \begin{align}
    \inv{\Delta_{\X}} \Delta_{\X}
      &= (\Delta_{\X} \times 1) \<\pi_0 \pi_0,\<\pi_0 \pi_1,\pi_1\>\>(1\times\inv{\Delta_{\X}})
      \label{eq:frobenius_righths_expressed_in_x}\\
    \inv{\Delta_{\X}}\Delta_{\X}
      &= (1 \times \Delta_{\X}) \<\<\pi_0, \pi_1 \pi_0\>,\pi_1 \pi_1\>(\inv{\Delta_{\X}}\times 1).
      \label{eq:frobenius_lefths_expressed_in_x}
  \end{align}
  We will detail the proof of Equation~\ref{eq:frobenius_righths_expressed_in_x}.
  Equation~\ref{eq:frobenius_lefths_expressed_in_x} may be proven similarly.

  Note first that $\Delta(1 \times !)$ (and $\Delta(!\times 1)$) is the identity. Second, we see
  that maps to a product of objects may be split into a product map --- i.e.  if
  $f:A \to B \times B$, then $f = \<f(1\times !), f(!\times 1)\>$.

  Using this we see that the left hand side of Equation~\eqref{eq:frobenius_righths_expressed_in_x}
  computes as follows:
  \begin{align*}
    \inv{\Delta_{\X}} \Delta_{\X}
      & = \<\inv{\Delta_{\X}} \Delta_{\X}(1\times !), \inv{\Delta_{\X}} \Delta_{\X} (! \times 1)\>\\
    &= \<\inv{\Delta_{\X}}, \inv{\Delta_{\X}} \>
  \end{align*}
  Similarly, removing the associativity maps, the right hand side of the same equation becomes:
  \begin{align*}
    (\Delta_{\X} \times 1) (1\times\inv{\Delta_{\X}}) &
      = \<(\Delta_{\X} \times 1) (1\times\inv{\Delta_{\X}}) (1\times !),
      (\Delta_{\X} \times 1) (1\times\inv{\Delta_{\X}}) (! \times 1 )\> \\
    &= \<(\Delta_{\X} \times 1) (1\times\inv{\Delta_{\X}}) (1\times ! ), \inv{\Delta_{\X}}\> \\
    &= \<(\Delta_{\X} \times 1) (1\times\inv{\Delta_{\X}}) (1 \times \Delta_{\X})(1\times !\times !), \inv{\Delta_{\X}}\> \\
    &= \<(\Delta_{\X} \times 1) (1\times\rst{\inv{\Delta_{\X}}}) (1\times !\times !), \inv{\Delta_{\X}}\> \\
    &= \<(\Delta_{\X} \times 1) \rst{1\times\inv{\Delta_{\X}}} (1\times !\times !), \inv{\Delta_{\X}}\> \\
    &= \<\rst{(\Delta_{\X} \times 1) (1\times\inv{\Delta_{\X}})}
      (\Delta_{\X} \times 1)(1\times !\times !), \inv{\Delta_{\X}}\> \\ %rfour
    &= \<\rst{(\Delta_{\X} \times 1) (1\times\inv{\Delta_{\X}})} (1\times !), \inv{\Delta_{\X}}\> \\
      &= \<\rst{(\Delta_{\X} \times 1) (1\times\inv{\Delta_{\X}})(! \times 1)} (1\times !),
      \inv{\Delta_{\X}}\> \\ % add total to right of rst
    &= \<\rst{\inv{\Delta_{\X}}} (1\times !), \inv{\Delta_{\X}}\> \\
    &= \<\inv{\Delta_{\X}}\Delta_{\X}(1\times !), \inv{\Delta_{\X}}\> \\
    &= \<\inv{\Delta_{\X}}, \inv{\Delta_{\X}}\>
  \end{align*}
  and therefore we see that the first equation for the Frobenius condition is satisfied. Thus,
  $Inv(\X)$ is a discrete inverse category.
\end{proof}
% subsection the_inverse_subcategory_of_a_graphic_cartesian_restriction_category (end)

% section inverse_products (end)

\section{Completing a discrete inverse category} % (fold)
\label{sec:completing_a_discrete_inverse_category}

The purpose of this section is to prove that the category of discrete inverse categories is
equivalent to the the category of discrete restriction categories. In order to prove this, we show
how to construct a discrete restriction category, \Xt, from a discrete inverse category, \X.

\subsection{Equivalence classes of maps in \hypX} % (fold)
\label{sub:equivalence_classes_of_maps_in_hypx}


\begin{definition}\label{defn:xequivalence}
  In a discrete inverse category \X as defined above, the map $f$ is equivalent to $f'$ in \X when
  $\restr{f} = \restr{f'}$ in \X and the below diagram commutes for some map $h$:
  \[
    \xymatrix @C=40pt @R=15pt{
      & & B \* C \ar@{.>}[dr]^{(\Delta\* 1) \, a_{\*}}\\
      && & B \* (B\* C) \ar@{.>}[dd]^{1\* h} \\
      A \ar[uurr]^f \ar[ddrr]_{f'}&&&\\
      && & B \* (B \* C') \ar@{.>}[dl]^(.4){\ \inv{a_{\*}}\,(\inv{\Delta}\* 1)}\\
      && B\* C'
    }
  \]
\end{definition}

\begin{notation}
  When $f$ is equivalent to $g$ via the mediating map $h$, this is written as:
  \[
    f\xequiv{h}g.
  \]
\end{notation}

\begin{lemma}\label{lem:mediating_map_equivalence_is_symmetric_reflexive_and_transitive}
  Definition~\ref{defn:xequivalence} gives a symmetric, reflexive equivalence class of maps in \X.
\end{lemma}
\begin{proof}
  \prepprooflist
  \begin{description}
    \itembf{Reflexivity: } Choose $h$ as the identity map.
    \itembf{Symmetry: } Suppose $f\xequiv{h}g$. Then, $\restr{f} = \restr{g}$ and $f k = g$ where
      \[
        k = (\Delta\* 1) \, a_{\*}\, (1\*h)\, \inv{a_{\*}}\,(\inv{\Delta}\* 1).
      \] Applying $\inv{k}$,
      which is
      \[
        (\Delta\* 1) \, a_{\*}\, (1\*\inv{h})\, \inv{a_{\*}}\,(\inv{\Delta}\* 1),
      \]
      we have
      \[
        g \inv{k} = f k \inv{k} = f \restr{k} = \restr{f k} f
        = \restr{g} f = \restr{f} f = f.
      \]

      Thus, $g\xequiv{\inv{h}} f$.

    \itembf{Transitivity: } Suppose $f\xequiv{h} f'$ and $f' \xequiv{k} f''$. Consider the
      compositions of the mediating portions of the equivalences:
      \[
        \ell = ((\Delta \* 1)  a_{\*}  (1 \* h ) \inv{a_{\*}} (\inv{\Delta}\* 1))
          ( (\Delta \* 1) a_{\*}  (1 \* k) \inv{a_{\*}} (\inv{\Delta}\* 1)).
      \]
      By pasting the diagrams which give the above equivalences, we see that $f \ell = f''$.
      However, $\ell$ is not in the form of a mediating map as presented.

      The claim is that $\ell$ is the actual mediating map for $f$ and $f''$. That is, that we have
      $f(\Delta \* 1)a_{\*}(1 \* \ell)\inv{a_{\*}}(\inv{\Delta}\*1) = f''$. In the interest of some
      brevity, this is shown below with the associativity maps elided from the equations.

      We need to show that $(\Delta \* 1)(1 \* \ell)(\inv{\Delta}\*1) = \ell$.
      \begin{align*}
        (\Delta &\* 1)(1 \* \ell)(\inv{\Delta}\*1) \\
        &=
          (\Delta \* 1)(1\*\Delta \* 1)  (1\*1 \* h ) (1\*\inv{\Delta}\* 1))\\
          &\qquad
            (1\*\Delta \* 1) (1\* 1 \* k) (1\*\inv{\Delta}\* 1)(\inv{\Delta}\* 1)\\
        &=
          (\Delta \* 1)(\Delta \* 1\*1)  (1\*1 \* h ) (1\*\inv{\Delta}\* 1))\\
          & \qquad
            (1\*\Delta \* 1) (1\* 1 \* k) (\inv{\Delta}\*1\* 1)(\inv{\Delta}\* 1)
              &\text{co-associativity}\\
        &=
          (\Delta \* 1)  (1 \* h ) (\Delta \* 1\*1)(1\*\inv{\Delta}\* 1)) \\
          &\qquad
            (1\*\Delta \* 1)  (\inv{\Delta}\*1\* 1)(1 \* k)(\inv{\Delta}\* 1)&\text{Naturality}\\
        &=
          (\Delta \* 1)  (1 \* h ) (\inv{\Delta} \*1)(\Delta\* 1)) \\
          &\qquad
            (\inv{\Delta} \* 1)  (\Delta \* 1)(1 \* k)(\inv{\Delta}\* 1)&\text{Frobenius}\\
        &=
          (\Delta \* 1)  (1 \* h ) (\inv{\Delta} \*1)
          (\Delta \* 1)(1 \* k)(\inv{\Delta}\* 1)&\Delta\text{ Total}\\
        &= \ell
      \end{align*}
  \end{description}
  and therefore $f\xequiv{\ell}f''$.
\end{proof}

\begin{corollary}\label{cor:equivalence_simplified_diagram}
  If $\restr{f} = \restr{g}$ in \X, a discrete inverse category, and the diagram
  \[
    \xymatrix @C=40pt @R=15pt{
      & & B \* C \ar@{.>}[dd]^{1\*h}\\
      A \ar[urr]^f \ar[drr]_{g}\\
      && B\* C'
    }
  \]
  commutes for some $h$, then there is a $h'$ such that $f\xequiv{h'}g$.
\end{corollary}
\begin{proof}
  Consider
  \begin{align*}
    (\Delta \*1)\,a_{\*}\,(1\*(1\*h))\,&\inv{a_{\*}}(\inv{\Delta}\*1)\\
    & = (\Delta \*1)\,((1\*1)\*h)\,a_{\*}\inv{a_{\*}}(\inv{\Delta}\*1) & \text{Naturality}\\
    &=(\Delta \*1)\,((1\*1)\*h)\,(\inv{\Delta}\*1) & \text{Isomorphism Inverse}\\
    &=(\Delta (1\*1) \inv{\Delta})\* h & \text{Naturality of }\*\\
    &=(1\* h) & \Delta  \inv{\Delta}=1\\
  \end{align*}
  and therefore we can set $h' = 1 \* h$.
\end{proof}
% end_fold sub:equivalence_classes_of_maps_in_hypx

\subsection{The restriction category \hypXt} % (fold)
\label{sub:the_restriction_category_hypxt}

\begin{definition}\label{def:xt}
  When \X is an inverse category, define \Xt\ as:
  \category{objects as in \X}
  {
    equivalence classes of maps as in Definition~\ref{defn:xequivalence} with the following
    structure in \X: %
    \[
      \infer{A\xrightarrow{f} B\*C \text{ in }\X}{A \xrightarrow{\ (f,C)\ } B \text{ in } \Xt}
      \]
  }
  {% identity
    by
    \[
      \infer{A\xrightarrow{\inv{u_{\*}^r}}A\* 1}
            {A \xrightarrow{(\inv{u_{\*}^r}, 1)} A}
    \]
  }
  {% composition
    given by
    \[
      \infer{
        \infer{A\xrightarrow{(f (g\*1) a_{\*},C' \* B')} C}
              {A\xrightarrow{f (g\*1) a_{\*}} C \* (C' \* B')}
            }
            {A \xrightarrow{\ (f,B')\ } B \xrightarrow{\ (g,C')\ } C}
    \]
  }

\end{definition}

When considering an \Xt\ map $(f,C):A\to B$ in \X, we occasionally use the notation $f:A\to
\xtdmn{B}{C}$ ($\equiv f:A\to B\* C$).

\begin{lemma}\label{lem:xt_is_a_category}
  \Xt\ as defined above is a category.
\end{lemma}
\begin{proof}
  The maps are well defined, as shown in
  Lemma~\ref{lem:mediating_map_equivalence_is_symmetric_reflexive_and_transitive}. The existence of
  the identity map is due to the tensor $\*$ being defined on \X, an inverse category, hence
  $\inv{\usr}$ is defined.

  It remains to show the composition is associative and that $(\inv{\usr}, 1)$ acts as an identity
  in \Xt.

  \textbf{Associativity:}
  Consider
  \[
    A\xrightarrow{(f,B')}B\xrightarrow{(g,C')} C \xrightarrow{(h,D')}D.
  \]

  To show the associativity of this in \Xt, we need to show in \X that
  \[
    \restr{(f(g\*1)a_{\*}) (h\*1)a_{\*}} = \restr{f (((g(h\*1)a_{\*})\*1) a_{\*})}
  \]
  and that there exists a mediating map between the two of them.

  To see that the restrictions are equal, first note that by the functorality of $\*$, for any two
  maps $u$ and $v$, we have $u v \* 1 = (u\*1) (v\*1)$. Second, the naturality of $a_{\*}$ gives us
  that $a_{\*} (h \* 1) = ((h\*1)\*1) a_{\*}$. Thus,
  \begin{align*}
    \restr{f(g\*1)a_{\*} (h\*1)a_{\*}}
      & = \restr{f(g\*1)a_{\*} (h\*1)\restr{a_{\*}}}
    & \text{Lemma \ref{lem:restrictionvarious}} \\
    & = \restr{f(g\*1)a_{\*} (h\*1)} & \restr{a_{\*}}=1 \\
    & = \restr{f(g\*1) ((h\*1)\*1) a_{\*} } & a_{\*}\text{ natural} \\
    & = \restr{f(g\*1) ((h\*1)\*1) }
      & a_{\*}   \text{ iso, Lemma \ref{lem:restrictionvarious}}\\
    & = \restr{f(g\*1) ((h\*1)\*1) (a_{\*}\*1)}
      & a_{\*}\*1 \text{ iso, Lemma \ref{lem:restrictionvarious}}\\
    & = \restr{f((g (h\*1)a )\*1)} & \text{ see above}\\
    & = \restr{f((g (h\*1)a )\*1)a_{\*}} & a_{\*}   \text{ iso}
  \end{align*}

  For the mediating map, see the diagram below, where the calculation is in \X. The path starting at
  the top left at $A$ and going right to \xtdmn{D}{D' \* (C' \* B')} is grouping parentheses to the
  left. Starting at $A$ and then going down to $\xtdmn{(\xtdmn{D}{D' \* C'})}{B'}$ followed by
  right to $ \xtdmn{D}{(D' \* C') \* B'}$ is grouping parentheses to the right. The
  commutativity of the diagram is shown by the commutativity of the internal portions, which all
  follow from the standard coherence diagrams for the tensor and naturality of association.

  \[
    \xymatrix @C=35pt @R=35pt{
      A \ar[d]_f \ar[r]^(.4){f (g\*1) a_{\*}} \ar[dr]^(.4){f(g\*1)} &
        \xtdmn{C}{C' \* B'} \ar[r]^{h\*1}
        & \xtdmn{(\xtdmn{D}{D'})}{C' \* B'} \ar[r]^{a_{\*}}
        & \xtdmn{D}{D' \* (C' \* B')}
        \ar@{.>}[dd]^{1\*\inv{a_{\*}}}\\
      \xtdmn{B}{B'} \ar[d]_{(g (h\*1) a_{\*})\*1} \ar[r]^{g\*1}
        &\xtdmn{(\xtdmn{C}{C'})}{B'} \ar[u]_{a_{\*}} \ar[r]^(.4){(h\*1)\*1}
        & \xtdmn{(\xtdmn{(\xtdmn{D}{D'})}{C'})}{B'}
        \ar[u]_{a_\*} \ar[dll]_{a_{\*}\*1}
      \\
      \xtdmn{(\xtdmn{D}{D' \* C'})}{B'}  \ar[rrr]_{a_{\*}}
        &&& \xtdmn{D}{(D' \* C') \* B'} %\ar @/^14pt/ [uu]^{1\*a_{\*}}
    }
  \]
  From this, we can conclude
  \[
    (f(g\*1)a_{\*}) (h\*1)a_{\*} \xequiv{1\*\inv{a_{\*}}} f (((g(h\*1)a_{\*})\*1) a_{\*})
  \]
  which gives us that composition in \Xt is associative.

  \textbf{Identity:} This requires:
  \[
    (f,C) (\inv{\usr}, 1) = (f,C) = (\inv{\usr}, 1) (f,C)
  \]
  for all maps $A\xrightarrow{(f,C)}B$ in \Xt.
  By Lemma~\ref{lem:restrictionvarious} we have
  $\restr{f (\inv{\usr}\*1) a_{\*}} = \restr{f}$. Then, calculating in \X, we have a mediating map
  of $1 \* \usl$ as shown below.
  \[
    \xymatrix @C=50pt @R=45pt{
      A \ar[r]^f \ar[ddrrr]_f&
        B \* C \ar[r]^(.4){\inv{\usr}\*1}
        \ar@/_20pt/[rr]_{1 \* \inv{\usl}}
        \ar@{=}[ddrr]
        & (B \* 1) \* C \ar[r]^{a_{\*}}
        & B \* (1 \* C) \ar@{.>}[dd]^{1 \* \usl} \\
      \\
      &&& B \* C.
    }
  \]
  $\restr{\inv{\usr} (f \*1)  a_{\*}} = \restr{f}$ by the naturality of $\inv{\usr}$ and
  Lemma~\ref{lem:restrictionvarious}. The diagram
  \[
    \xymatrix @C=50pt @R=45pt{
      A \ar@{=}[dd] \ar[r]^{\inv{\usr}} \ar[dr]_{f}
        &      A \* 1 \ar[r]^{f \* 1}
        & (B \* C) \* 1 \ar[r]^{a_{\*}}
        & B \* (C \* 1)\ar@{.>}[dd]^{1 \* \usr} \\
      &B\*C \ar[ur]^{\inv{\usr}} \ar[urr]_{1\*\inv{\usr}} \ar@{=}[drr]\\
      A \ar[rrr]^f &&& B \* C
    }
  \]
  shows our mediating map is $1 \* \usr$.
\end{proof}


Define the restriction in \Xt\ as follows:
\[
  \infer{A\xrightarrow{\restr{f}  \inv{u_{\*}^r}} A\*1 \text{ in }\X}
        {\infer{A\xrightarrow{\restr{(f,C)}}A}
               {A\xrightarrow{(f,C)}B}
        }
\]

\begin{lemma}\label{lem:xt_is_a_restriction_category}
  The category \Xt with restriction defined as above is a restriction category.
\end{lemma}
\begin{proof}
  Given the above definition the four restriction axioms must now be checked. For the remainder of
  this proof, all diagrams will be in $\X$.
  \begin{description}
    \item[\rone] ($\restr{f} f = f$) Calculating the restriction of the left hand side in
      \X, we have:
      \begin{align*}
        \restr{\rst{f}\inv{\usr} (f\*1) a_{\*}} & = \restr{\rst{f}\inv{\usr} (f\*1)}
          & a_{\*}   \text{ iso, Lemma \ref{lem:restrictionvarious}}\\
        & = \restr{\rst{f}f \inv{\usr}}  & \inv{\usr} \text{ natural}\\
        & = \restr{f \inv{\usr}}  & \text{ \rone in }\X\\
        & = \restr{f } & \inv{\usr}   \text{ iso, Lemma \ref{lem:restrictionvarious}}.
      \end{align*}

      Then, the following diagram
      \[
        \xymatrix @C=40pt @R=25pt{
          A \ar[r]^{\restr{f} \inv{\usr}}
          \ar @/_25pt/[ddrrr]_f  \ar[drr]^{\restr{f}f}
          &A \* 1 \ar[r]^{f\* 1}
          &(A \* B) \* 1 \ar[r]^{a_{\*}} \ar[ddr]^{\usr}
          &A \* (B \* 1) \ar@{.>}[dd]^{1 \* {\usr}}\\
          &&A\*B \ar[u]^{\inv{\usr}} \ar@{=} [dr]\\
          && &A \* B
        }
      \]
      shows $\rst{f}\inv{\usr} (f\*1) a_{\*} \xequiv{1 \* {\usr}} f$ in \X and therefore $\rst{f}f
      = f$ in \Xt.


    \item[\rtwo] ($\restr{g} \restr{f} = \restr{f} \restr{g}$) We must show
      \begin{equation}
        \rst{f}\inv{\usr} ((\restr{g}\inv\usr)\*1)) a_{\*} \xequiv{}
        \rst{g}\inv{\usr}((\restr{f}\inv\usr)\*1) a_{\*}.
        \label{eq:rtwo_in_xt}
      \end{equation}
      The restriction of the left hand
      side equals the restriction of the right hand side as seen below:
      \begin{align*}
        \restr{\rst{f}\inv{\usr} ((\restr{g}\inv\usr)\*1)) a_{\*}}
        & = \restr{\rst{f}(\restr{g}\inv\usr)\inv{\usr} a_{\*}} & \inv{\usr}   \text{ natural}\\
        & = \restr{\rst{g}\restr{f}\inv\usr\inv{\usr} a_{\*}} &  \text{\rtwo in }\X\\
        & = \restr{\rst{g}\inv{\usr}((\restr{f}\inv\usr)\*1) a_{\*}} & \inv{\usr}   \text{natural}.
      \end{align*}

      %\note{!!!!! Above calc works without being under restr, therefore have we not just shown
      %that $\restr{g}  \restr{f} = \restr{f}  \restr{g}$ ????
      %Note that the mediating map is $id$!!!!!!!!!}

      The below diagram commutes by the naturality of $\usr$ and the tensor coherence,
      \[
        \xymatrix @C=48pt @R=55pt{
          A \ar[r]^{\restr{g} \inv{\usr}}
            \ar[dr]_{\restr{f}\restr{g}}^{\restr{g}\restr{f}}
            \ar[d]_{\restr{f}\inv{\usr}}
            &A\*1 \ar[r]^(.4){(\rst{f}\inv{\usr})\*1}
            & (A \*1) \* 1
            \ar[r]^{a_{\*}}  \ar[dl]_{\usr \usr}
            & A \* (1\*1) \ar@{.>}[dd]_{1\*id}\\ %\ar @/^25pt/ @{=}[dd]
          A\*1 \ar[d]_{(\rst{g}\inv{\usr})\*1}
            &A \ar@/_25pt/[ur]_{\inv{\usr}\inv{\usr}} \\
             %\ar@/^25pt/[dl]^(.3){\inv{\usr}\inv{\usr}}\\
          (A\*1)\*1 \ar[rrr]_{a_\*} \ar[ur]^{\usr \usr}
            &&& A \* (1\*1)
        }
      \]
      which allows us to conclude $\rst{f} \rst{g} = \rst{g} \rst{f}$ in \Xt.

    \item[\textbf{R.3}] ($\restr{\restr{f} g} = \restr{f} \restr{g}$ ). We must show
      \begin{equation}
        \restr{(\restr{f} \inv{\usr}) (g\* 1) a_{\*}} \inv{\usr} \xequiv{}
        (\restr{f} \inv{\usr})(\rst{g} \inv{\usr}\* 1) a_{\*}
        \label{eq:rthree_in_xt}
      \end{equation}
      As above, the first step is
      to show that the restrictions of each side of Equation~\ref{eq:rthree_in_xt} are the same.
      Computing the restriction of the left
      hand side in \X:
      \begin{align*}
        \rst{\restr{(\restr{f} \inv{\usr}) (g\* 1) a_{\*}} \inv{\usr}}
        & = \rst{\restr{(\restr{f} \inv{\usr}) (g\* 1) a_{\*}}} & \inv{\usr}
          \text{ iso, Lemma \ref{lem:restrictionvarious}}\\
        & = \restr{(\restr{f} \inv{\usr}) (g\* 1) a_{\*}} &
          \text{Lemma \ref{lem:restrictionvarious}}\\
        & = \restr{\restr{f} g \inv{\usr} a_{\*}} & \inv{\usr} \text{ natural}\\
        & = \restr{\restr{f} g } & \inv{\usr}, a_{\*}
          \text{ iso, Lemma \ref{lem:restrictionvarious}}\\
        & = \restr{f} \rst{g} & \text{\rthree in }\X.
      \end{align*}
      The restriction of the right hand side computes in \X as:
      \begin{align*}
        &\rst{(\restr{f} \inv{\usr})(\rst{g} \inv{\usr}\* 1) a_{\*}}\\
        & = \rst{(\restr{f} \inv{\usr}) (\rst{g} \inv{\usr}\* 1) } &  a_{\*}
          \text{ iso, Lemma \ref{lem:restrictionvarious}}\\
        & = \rst{\restr{f}  \rst{g} \inv{\usr}\inv{\usr} } &  \inv{\usr} \text{ natural}\\
        & = \rst{\restr{f}  \rst{g} } &\inv{\usr}\inv{\usr}
          \text{ iso, Lemma \ref{lem:restrictionvarious}}\\
        & = \restr{f} \rst{g} & \text{Lemma \ref{lem:restrictionvarious}}.
      \end{align*}

      Additionally, we see $\rst{\rst{f} g}$ in \Xt is expressed in \X as:
      \begin{align*}
        &\restr{(\restr{f} \inv{\usr})(g\* 1) a_{\*}} \inv{\usr} \\
        & = \rst{f} \inv{\usr} \rst{g\* 1} & \text{\rthree, \rfour, }a_{\*} \text{ iso} \\
        & = \rst{f} \rst{g} \inv{\usr} & \*
          \text{a restriction bi-functor, }\inv{\usr}\text{ natural.}
      \end{align*}

      The following diagram in \X follows the right hand side of Equation~\ref{eq:rthree_in_xt}
      with the top curved arrow and the left hand side of Equation~\ref{eq:rthree_in_xt} with the
      bottom curved arrow. Note that we are using that
      $\restr{(\restr{f} \inv{\usr}) (g\* 1) a_{\*}} = \restr{f}\rst{g}$ as shown above.
      \[
        \xymatrix @C=33pt @R=20pt{
          A \ar@/^45pt/[rrrrr]^{\restr{f} \inv{\usr}(\restr{g} \inv{\usr} \* 1)a_{\*}}
            \ar@/_65pt/[dddddrrrrr]_{\restr{f}\, \restr{g}\inv{\usr}}
            \ar[r]^(.7){\restr{f}}
            \ar[dr]_(.7){\restr{f}}
            &A \ar[r]^{\inv{\usr}}
            \ar@{=}[d]
            &A \* 1 \ar[r]^{\restr{g}\*1}
            \ar[dd]_{\usr}
            &A \* 1 \ar[r]^(.41){\inv{\usr}\* 1}
            \ar[ddd]_{\usr}
            &(A \* 1) \* 1 \ar[r]^{a_{\*}}
            \ar[dddd]_{\usr}
            & A \* (1\*1) \ar@{.>}[ddddd]^{1\*\usr}\\
          &A\ar@{=}[dr]\\
          &&A \ar[dr]_{\restr{g}}\\
          &&&A \ar[dr]_{\inv\usr}\\
          &&&&A\*1 \ar@{=}[dr]\\
          &&&&&A\*1
        }
      \]
      Hence, in \X, $\restr{(\restr{f} \inv{\usr}) (g\* 1) a_{\*}} \inv{\usr} \xequiv{1\*\usr}
      (\restr{f} \inv{\usr}) (\rst{g} \inv{\usr}\* 1) a_{\*}$ and therefore $\restr{\restr{f} g} =
      \restr{f} \restr{g}$ in \Xt.



    \item[\textbf{R.4}] $f \restr{g} = \restr{f g} f$ We must show
      \begin{equation}
        f (\restr{g} \inv{\usr}\* 1) a_{\*} \xequiv{}
        \rst{f (g \* 1)} \inv{\usr} (f\* 1) a_{\*}
        \label{eq:rfour_in_xt}
      \end{equation}
      The restriction of the left hand side of Equation~\ref{eq:rfour_in_xt} is:
      \begin{align*}
        \rst{f (\restr{g} \inv{\usr}\* 1) a_{\*}}
          & = \rst{f (\restr{g} \inv{\usr}\* 1)} & a_{\*}
          \text{ iso, Lemma \ref{lem:restrictionvarious}} \\
        & = \rst{f \rst{g} \inv{\usr}} \* \rst{f} & \* \text{ restriction functor}\\
        & = \rst{f \rst{g}} \* \rst{f} & \inv{\usr}
          \text{ iso, Lemma \ref{lem:restrictionvarious}} \\
        & = \rst{f (\rst{g} \* 1)}
      \end{align*}
      and the restriction of the right hand side of Equation~\ref{eq:rfour_in_xt}  is:
      \begin{align*}
        \rst{\rst{f (g \* 1)} \inv{\usr} (f\* 1) a_{\*}}
          & = \rst{\rst{f (g \* 1)} \inv{\usr} (f\* 1) } & a_{\*}
          \text{ iso, Lemma \ref{lem:restrictionvarious}}\\
        & = \rst{\rst{f (g \* 1)} f \inv{\usr}  } & \inv{\usr} \text{ natural}\\
        & = \rst{f \rst{(g \* 1)}  \inv{\usr}  } & \text{ \rfour for }\X\\
        & = \rst{f (\rst{g} \* 1)  \inv{\usr}  } & \* \text{ is a restriction functor}\\
        & = \rst{f (\rst{g} \* 1)    } & \inv{\usr}
          \text{ iso, Lemma \ref{lem:restrictionvarious}}
      \end{align*}

      Computing the right hand side of Equation~\ref{eq:rfour_in_xt} in \X,
      \begin{align*}
        \rst{f(g\* 1)a_{\*}} \inv{\usr} (f\* 1) a_{\*}
          & = \rst{f(g\* 1)} f \inv{\usr} a_{\*} & a_{\*} \text{ iso, } \inv{\usr}\text{ natural.}\\
        & = f (\rst{g} \* 1) \inv{\usr} a_{\*} & \rthree, \* \text{ a restriction functor.}
      \end{align*}
      \[
        \xymatrix @C=40pt @R=35pt{
          A \ar[r]^f \ar[dr]_{f}
            & B\* C \ar[rr]^{\restr{g} \inv{\usr}\* 1}
            &
            & (B\* 1) \* C \ar[r]^{a_{\*}}
            & B \* (1 \* C)\ar@{.>}[d]^{1\*c_{\*}}\\
          & B\*C \ar[r]_{\rst{g}\*1}
            & B \* C \ar[r]_{\inv{\usr}}
            & (B \* C) \* 1 \ar[r]_{a_{\*}}
            & B \* (C\*1)
        }
      \]
  \end{description}

  and hence, \Xt\ is a restriction category.
\end{proof}
% subsection the_restriction_category_hypxt (end)
\subsection{The category \hypXt is a discrete restriction category} % (fold)
\label{sub:the_category_hypxt_is_cartesian}



\begin{lemma}\label{lem:tensor_unit_of_x_is_terminal_object_of_xt}
  The unit of the inverse product in \X is the terminal object in \Xt.
\end{lemma}
\begin{proof}
  The unique map to the terminal object for any object $A$ in \Xt is the equivalence class of maps
  represented by $(\inv{\usl},A)$. For this to be a terminal object, the diagram
  \[
    \xymatrix @C=40pt @R=25pt{
      X \ar[r]^{\restr{(f,C)}} \ar[d]^{(f,C)} & X \ar[r]^{!_X}  &\top  \\
      Y \ar[urr]_{!_Y}
    }
  \]
  must commute for all choices of $f$. Translating this to \X, this is the same as requiring
  \[
    \xymatrix @C=40pt @R=25pt{
      X \ar[r]^{\restr{f}} \ar[d]^{f} & X \ar[r]^{\inv{\usr} }
      & X\*1 \ar[r]^{\inv{\usl}}  &1\*X\*1 \ar@{.>}[dl]_{1\*(\usr f)}  \\
      Y \*C\ar[rr]_{\inv{\usl}} & & 1 \*Y \* C
    }
  \]
  commute, which is true by \rone and from the coherence diagrams for the inverse product tensor.
\end{proof}

Next,we show that the category \Xt\ has restriction products, given by the action of \wtc on
the $\*$ tensor in \X.

First, define total maps $\pi_0$, $\pi_1$ in \Xt by:
\begin{align}
  \pi_0:\qquad & A \* B \xrightarrow{(1,B)} A \label{eq:defn:pia}\\
  \pi_1:\qquad & A \* B \xrightarrow{(c_{\*},A)} B \label{eq:defn:pib}
\end{align}

\begin{definition}\label{def:product_map_in_xt}
  Given a discrete inverse category $\X$, suppose we are given the maps $ Z \xrightarrow{(f,C)} A$
  and $Z \xrightarrow{(g,C')} B$ in $\Xt$. Then define $\<(f,C),(g,C')\>$as
  \begin{equation}
    Z\xrightarrow{(\Delta  ( f \* g )  (1\* c_{\*} \* 1), C\* C')} A \* B\label{eq:defn:fg}
  \end{equation}
  where associativity is assumed as needed. Note that with the associativity maps, this is actually:
  \begin{equation}
    Z\xrightarrow{(\Delta  ( f \* g )  a_{\*} (1\*\inv{a_{\*}})
      (1\* (c_{\*} \* 1)) (1\*a_{\*}) \inv{a_{\*}}, C\* C')} A \* B\label{eq:defn:fg2}
  \end{equation}
\end{definition}

\begin{lemma}\label{lem:tensor_on_x_is_the_restriction_product_on_xt}
  On \Xt, $\*$ is a restriction product with projections $\pi_0, \pi_1$ and the product of maps
  $f, g$ being $\<f,g\>$.
\end{lemma}
\begin{proof}
  From the definition above, as $1$ and $c_{\*}$ are isomorphisms, the maps $\pi_0, \pi_1$ are
  total.

  In order to show that $\rst{\<f,g\>} = \rst{f}\,\rst{g}$, first reduce the left hand side:
  \begin{align*}
    \rst{\<f,g\>}
      &=\rst{\Delta(f\*g)(1\*c_{\*}\*1)}\inv{\usr}&\text{in }\X, \text{ definition of restriction}\\
    &=\rst{\Delta(f\*g)}\inv{\usr} &c_{\*}\text{ is iso}\\
    &=\rst{\Delta\rst{(f\*g)}}\inv{\usr} &\text{from Lemma \ref{lem:restrictionvarious}}\\
    &=\rst{\Delta(\rst{f}\*\rst{g})}\inv{\usr} &\*\text{ is a restriction functor}\\
    &=\rst{\rst{f}\,\rst{g}\,\Delta(1\*1)}\inv{\usr}
      &\text{Lemma  \ref{lem:properties_of_delta_and_tensor_in_a_discrete_inverse_category}(\ref{le:deltaefg}) twice}\\
    &=\rst{\rst{f}\,\rst{g}}\inv{\usr} &\text{Lemma  \ref{lem:restrictionvarious}}\\
    &=\rst{f}\,\rst{g}\inv{\usr}  &\text{Lemma  \ref{lem:restrictionvarious}.}\\
  \end{align*}

  Then, the right hand side reduces as:
  \begin{align*}
    \rst{f} \rst{g}
    &= \rst{f}\inv{\usr}(\rst{g}\inv{\usr} \* 1) a_{\*} & \text{in \X by definitions}\\
    &= \rst{f} \rst{g}\inv{\usr}\inv{\usr} a_{\*} &  \inv{\usr}\text{ natural.}
  \end{align*}
  The restriction of the left hand side and the right hand side, in \X, is $\rst{\rst{f} \rst{g}}$.
  This is done by applying Lemma~\ref{lem:restrictionvarious} once on the left and
  thrice on the right.

  Thus, this shows $\rst{\<f,g\>}=\rst{f} \rst{g}$ in \Xt where the mediating map in \X is
  $1\*\usr$.

  Next, to show $\<f,g\> \pi_0 \le f$ (and $\<f,g\> \pi_1 \le g$), it is required to show
  $\rst{\<f,g\>\pi_{0}} f = \<f,g\> \pi_{0}$. Calculating the left side, we see:
  \begin{align*}
    \rst{\<f,g\>\pi_{0}} f &=\rst{\<f,g\>\rst{\pi_{0}}} f &\text{Lemma \ref{lem:restrictionvarious}}\\
    &=\rst{\<f,g\>} f &\pi_{0}\text{ is total}\\
    &=\rst{f}\,\rst{g}\, f&\text{ by above}\\
    &=\rst{g} \rst{f} f & \rtwo\\
    &=\rst{g} f& \rone.
  \end{align*}
  Now, turning to the right hand side:
  \begin{align*}
    \<f,g\>\pi_{0} &= \Delta(f\*g)(1\*c_{\*}\*1) 1 &\text{in \X, by definition.}
  \end{align*}
  To show these are equal in \Xt, we need to first show the restrictions are the same in \X and
  then show there is a mediating map between the images in \X. The restriction of $\rst{g} f$ is
  $\rst{f} \rst{g}$ immediately by \rthree and \rtwo. For the right hand side, calculate in \X:
  \begin{align*}
    \rst{\Delta(f\*g)(1\*c_{\*}\*1)}
      & = \rst{\Delta(f\*g)} & \text{Lemma  \ref{lem:restrictionvarious}}\\
    & = \Delta(f\*g)(\inv{f} \* \inv{g})\inv{\Delta} & \X \text{ is an inverse category}\\
    & = \Delta(\rst{f} \* \rst{g})\inv{\Delta} & \\
    & = \rst{f} \rst{g} \Delta\inv{\Delta}
      & \text{Lemma \ref{lem:properties_of_delta_and_tensor_in_a_discrete_inverse_category}(\ref{le:deltaefg}) twice}\\
    & = \rst{f} \rst{g}.
  \end{align*}

  The diagram below, shows the required mediating map.
  \[
    \xymatrix @C=27pt @R=25pt{
      & & & A \* C \ar[dr]^{\Delta\*1}\\
      & & & & A \* A \* C \ar@{.>}[d]^{1\*\Delta}\\
      &Z\ar[uurr]^{f}& & & A \* A\* C \* A \* C\ar@{.>}[d]^{1\*1\*\inv{f}}\\
      Z\ar[ur]^{\rst{g}}\ar[dr]_{\Delta}&& & &  A \* A \*C \* Z \ar@{.>}[d]^{1 \* 1 \* 1 \* g}\\
      &Z\*Z\ar[dr]_{f\* g}& & & A\*A\*C\*B\*C'\ar@{.>}[d]^{1\*1\*c_{\*}\*1}\\
      &&A\*C\*B\* C'\ar[dr]_{1\*c_{\*}\*1}&&A\*A\*B\*C\*C'\ar[dl]^{\inv{\Delta}\*1\*1\*1}\\
      & & & A\*B\*C\*C'
    }
  \]
\end{proof}

% subsection the_category_hypxt_is_cartesian (end)

At this point, we have shown that \Xt is a restriction category with restriction products. This
leads us to the following theorem:

\begin{theorem}\label{thm:xt_is_a_discrete_crc_when_x_is_an_inverse_category}
  For any inverse category \X, the category \Xt is a discrete restriction category.
\end{theorem}
\begin{proof}
  The fact that \Xt is a Cartesian restriction category is immediate from
  Lemmas~\ref{lem:xt_is_a_category}, \ref{lem:xt_is_a_restriction_category},
  \ref{lem:tensor_unit_of_x_is_terminal_object_of_xt} and
  \ref{lem:tensor_on_x_is_the_restriction_product_on_xt}.

  To show that it is discrete, we need only show that the map $(\Delta \inv{\usr},1)$ is in the
  same equivalence class as $\Xt$'s $\Delta(= \<1,1\> = \<(\inv{\usr},1),(\inv{\usr},1))$. As both
  $\Delta$ and $\inv{\usr}$ are total, the restriction of each side is the same, namely $1$. The
  diagram below uses Corollary \ref{cor:equivalence_simplified_diagram} and shows that the two maps
  are in the same equivalence class.
  \[
    \xymatrix @C=190pt @R=40pt{
      & A \* A \* 1 \ar@{.>}[d]^{\inv{\usr}}\\
      A \ar[ur]^{\Delta\inv{\usr}}
        \ar[r]_{\Delta(\inv{\usr}\*\inv{\usr})(1\*c_{\*}\*1)}& A\*A\*1\*1
    }
  \]
\end{proof}
\subsection{Equivalence of categories} % (fold)
\label{sub:equivalence_of_categories}

This section will show that the category of discrete inverse categories (maps being restriction
functors that preserve the inverse tensor) is equivalent to the category of discrete restriction
categories (maps being the restriction functors which preserve the product). In the following, $\X$
will always be a discrete inverse category, $\D$ and $\C$ will be discrete restriction categories.

We approach the equivalence proof by exhibiting the universal property for discrete inverse
categories for the functor $\Invf$ from discrete restriction categories to discrete inverse
categories. The functor $\Invf$ maps a discrete restriction category to its inverse subcategory and
maps functors between discrete restriction categories to a functor having the same action on the
partial inverses. That is, given $G:\C \to \D$, then:
\begin{align*}
  &\Inv{G}: \Inv{\C} \to \Inv{\D}\\
  &\Inv{G}(A) = G{A}&\text{(all objects of $\D$ are in $Inv(\D)$)}\\
  &\Inv{G}(f) = G(f)&\text{(restriction functors preserve partial inverse)}
\end{align*}
We continue by showing the $\eta$ and $\varepsilon$ of the universal property are isomorphisms.
First, let $\eta:\X \to \Inv{\Xt}$ be an identity on objects functor. For maps $f$ in \X, $\eta(f)
= (f\inv{\usr},1)$.

Next, consider a functor $F:\X \to \Inv{\D}$ defined as follows:
\begin{description}
  \item{Objects:} $F^{\#}:A \mapsto F(A)$
  \item{Arrows:} $F^{\#}:(f,C) \mapsto F(f)\pi_0$
\end{description}

This allows us to write the diagram:
\begin{equation}
  \xymatrix @C=65pt @R=40pt{
    \X \ar[r]^{\eta} \ar[rd]_{F}& \Inv{\Xt} \ar[d]^{\Inv{F^{\#}}}\\
    &\Inv{\D}
  }
  \label{dia:universal_property_of_inverse_categories}
\end{equation}
In order to show this is a universal diagram, we proceed with a series of lemmas building to the
result.

\begin{lemma}\label{lem:all_invertible_maps_in_xt_are_of_the_form_f_inv_usr}
  For any discrete inverse category $\X$, all invertible maps $(g,C):A\to B$ in $\Xt$ are in the
  equivalence class of $(f \inv{\usr},1)$ for some $f:A\to B$.
\end{lemma}
\begin{proof}
  As $(g,C)$ is invertible in \Xt, the map $\inv{(g,C)}: B \to A$ exists. $\inv{(g,C)}$ must be in
  the equivalence class of some map $k:B \to A \* D$, and also note that $\rst{(g,C)}$ is by
  construction the equivalence class of the map $\rst{g}\inv{\usr}:A \to A\*1$ in \X. This means,
  diagramming in \X, there is an $n$ such that
  \[
    \xymatrix @C=45pt @R=25pt{
      B \ar[r]^{k} \ar[rrddd]_{\rst{k}\inv{\usr}}
        & A \*D \ar[r]^{f\*1}&B\*C\*D \ar[d]^{\Delta\*1}\\
      & &  B\*B\*C\*D \ar@{.>}[d]^{1\* n} \\
      & &  B\*B\*1 \ar[d]^{\inv{\Delta}\* 1}\\
      && B\* 1
    }
  \]
  commutes.

  Starting with $g:A\to B\*C$, construct the map $f$ in \X with the following diagram:
  \[
    \xymatrix @C=225pt @R=20pt{
      A \ar[r]^{g} \ar@{.>}[rdddddddd]_{f}& B \*C \ar[d]^{\Delta\*1}\\
      &B\*B\*C \ar[d]^{1\*\Delta\*1}\\
      &B\*B\*B\*C \ar[d]^{1\*1\*k\*1}\\
      &B\*B\*A\*D\*C \ar[d]^{1\*1\*g\*1\*1}\\
      &B\*B\*B\*C\*D\*C \ar[d]^{1\*\inv{\Delta}\*1\*c_{\*}}\\
      &B\*B\*C\*C\*D \ar[d]^{1\*1\*\inv{\Delta}\*1}\\
      &B\*B\*C\*D \ar[d]^{1\*n}\\
      &B\*B\*1 \ar[d]^{(\inv{\Delta}\* 1) \usl }\\
      &B
    }
  \]
  By its construction, $f:A\to B$ in \X and $(f\inv{\usr},1)$ are in the same equivalence class as
  $(g,C)$.

\end{proof}

\begin{lemma}\label{lem:universal_diagram_is_a_commutative_diagram}
  Diagram (\ref{dia:universal_property_of_inverse_categories}) above is a commutative diagram.

\end{lemma}
\begin{proof}
  Chasing maps around the diagram, we have:
  \[
    \xymatrix @C=35pt @R=40pt{
      f \ar@{|->}[rr]^{\eta} \ar@{|->}[rd]_{F}&& (f\inv{\usr},1) \ar@{|->}[d]^{\Inv{F^{\#}}}\\
      &F(f) \ar@{=}[r] & F(f\inv{\usr})\pi_0
    }
  \]
  As $\eta$ is identity on the objects, Diagram~\eqref{dia:universal_property_of_inverse_categories}
  commutes.
\end{proof}

\begin{lemma}\label{lem:inv_is_full_and_faithful}
  The functor $\Invf$ from the category of discrete restriction categories to the category of
  discrete inverse categories is full and faithful.
\end{lemma}
\begin{proof}
  To show fullness, we must show $\Invf$ is surjective on hom-sets. Given a functor between two
  categories in the image of $\Invf$, i.e., $G:\Inv{\C}\to \Inv{\D}$, construct a functor
  $H:\C\to\D$ as follows:
  \begin{description}
    \item{Action on objects:} $H(A) = G(A),$
    \item{Objects on maps:} $H(f) = G(\<f,1\>)\pi_0.$
  \end{description}
  $H$ is well defined as we know $\<f,1\>$ is an invertible map and therefore in the domain of $G$.
  To see $H$ is a functor:
  \begin{align*}
    H(1) &= G(\<1,1\>)\pi_0 = \Delta_{\D}\pi_0 = 1\\
    H(fg) &= G(\<fg,1\>)\pi_0 = G(\<f,1\>)\pi_0G(\<g,1\>)\pi_0 = H(f)H(g)
  \end{align*}
  But on any invertible map, $H(f) = G(\<f,1\>)\pi_0 = \<G(f),1\>\pi_0 = G(f)$ and therefore
  $\Inv(H) = G$, so $\Invf$ is full.

  Next, assume we have $F,G:\C\to\D$ with $\Inv{F} = \Inv{G}$. Considering $F(f)$ and $F(g)$, we
  know $F(\<f,1\>) = G(\<f,1\>) $ as $\<f,1\>$ is invertible. Thus, as the functors preserve the
  product structure, we have
  \[
    F(f) = F(\<f,1\>)F(\pi_0)= G(\<f,1\>)G(\pi_0)= G(f).
  \]
  Thus, $\Invf$ is faithful.
\end{proof}

\begin{corollary}\label{cor:f_sharp_is_unique}
  The functor $F^{\#}$ in Diagram~\ref{dia:universal_property_of_inverse_categories} is unique.
\end{corollary}
\begin{proof}
  This follows immediately from Lemma~\ref{lem:inv_is_full_and_faithful}, $\Invf$ is faithful.
\end{proof}
\begin{corollary}\label{cor:eta_and_xt_are_universal_for_inv}
  The category \Xt and functor $\eta:\X\to \Inv{\Xt}$ is a universal pair for the functor $\Invf$.
\end{corollary}
\begin{proof}
  Immediate from Corollary~\ref{cor:f_sharp_is_unique} and Lemma~\ref{lem:universal_diagram_is_a_commutative_diagram}.
\end{proof}

\begin{lemma}\label{lem:the_functor_eta_is_an_isomorphism}
  The functor $\eta:\X \to \Inv{\Xt}$ is an isomorphism.
\end{lemma}
\begin{proof}
  As $\eta$ is an identity on objects functor, we need only show that it is full and faithful.
  Referring to Lemma~\ref{lem:all_invertible_maps_in_xt_are_of_the_form_f_inv_usr} above, we
  immediately see that $\eta$ is full. For faithful, if we assume $(f\inv{\usr},1)$ is equal in \Xt
  to $(g\inv{\usr},1)$. This means in \X, that $\rst{f} = \rst{g}$ and there is a $h$ such that
  \[
    \xymatrix @C=40pt @R=15pt{
      & & B \* 1 \ar@{.>}[dr]^{(\Delta\* 1) \, a_{\*}}\\
      && & B \* (B\* 1) \ar@{.>}[dd]^{1\* h} \\
      A \ar[uurr]^{f\inv{\usr}} \ar[ddrr]_{g\inv{\usr}}&&&\\
      && & B \* (B \* 1). \ar@{.>}[dl]^(.4){\ \inv{a_{\*}}\,(\inv{\Delta}\* 1)}\\
      && B\* 1
    }
  \]
  This simplifies out to $g = f \Delta (1\* h) \inv{\Delta}$. But by
  Lemma~\ref{lem:properties_of_delta_and_tensor_in_a_discrete_inverse_category}, part \ref{le:restfg},
  $\Delta (1\* h) \inv{\Delta} = \rst{\Delta (1\* h) \inv{\Delta}}$. Setting $\Delta (1\* h)
  \inv{\Delta}$ as $k$, we have $g = f \rst{k}$. This gives us:
  \[
    g = f \rst{k} = \rst{f k} f = \rst{f \rst{k}} f = \rst{g} f = \rst{f} f = f.
  \]
  This shows $\eta$ is faithful and hence an isomorphism between $\X$ and $\Inv{\Xt}$.
\end{proof}

\begin{theorem}\label{thm:discrete_inverse_categories_are_equivalent_to_discrete_restriction_categories}
  The category of discrete inverse categories (objects are discrete inverse categories, maps are
  inverse tensor preserving functors) is equivalent to the category of discrete restriction
  categories (objects are discrete restriction categories, maps are the Cartesian restriction
  functors).
\end{theorem}
\begin{proof}
  From the above lemmas, we have shown that we have an adjoint:
  \begin{equation}
    (\eta,\varepsilon):\wtf \vdash \Invf :D_{ic} \to D_{rc} \label{eq:inv_and_wtf_are_adjoint_pair}
  \end{equation}
  By Lemma~\ref{lem:the_functor_eta_is_an_isomorphism} we know $\eta$ is an isomorphism. But this
  means the functor $\wtf$ is full and faithful, as shown in, e.g., Proposition 2.2.6 of
  \cite{cockett2009:ctcs}. From lemma \ref{lem:inv_is_full_and_faithful} we know that $\Invf$ is
  full and faithful. But again by the previous reference, this means $\varepsilon$ is an
  isomorphism. Thus, by Corollary \ref{cor:eta_and_xt_are_universal_for_inv} and Proposition 2.2.7
  of \cite{cockett2009:ctcs} we have the equivalence of the two categories.
\end{proof}
% subsection equivalence_of_categories (end)
\subsection{Examples of the \texorpdfstring{\wtc}{tilde} construction} % (fold)
\label{sub:examples_of_the_wtf_construction}

\begin{example}[Completing a finite discrete inverse category]
  \label{example:completing_a_finite_discrete_inverse_category}
\end{example}
Continuing from Example~\ref{example:invprodisstructure}, recall the discrete category of 4
elements with two different tensors. Completing these gives two different lattices. They are either
the straight line lattice, or the diamond semilattice. Below are the details of these constructions.

Recall $\D$ has four elements $a,b,c$ and $d$, and there are two possible inverse product tensors:
\begin{quote}\qquad\qquad
  \begin{tabular}{|l||c|c|c|c|}
    \hline
    $\*$&a&b&c&d\\ \hline \hline
    a&a&a&a&a\\ \hline
    b&a&b&\textbf{b}&b\\ \hline
    c&a&\textbf{b}&c&c \\ \hline
    d&a&b&c&d \\ \hline
  \end{tabular}
  \hfil
  \begin{tabular}{|l||c|c|c|c|} \hline
    $\*$&a&b&c&d\\ \hline \hline
    a&a&a&a&a\\ \hline
    b&a&b&\textbf{a}&b\\ \hline
    c&a&\textbf{a}&c&c \\ \hline
    d&a&b&c&d \\ \hline
  \end{tabular}
  \qquad \qquad
\end{quote}


Define $\Delta$ as the identity map. Then, for the first tensor, $\widetilde{\D}$ has the following
maps
\begin{align*}
  %a \xrightarrow{(id,a)} a \ (\equiv a \xrightarrow{(id, b)} a \equiv a \xrightarrow{(id,c)} a
  %\equiv a \xrightarrow{(id,d)} a), \qquad a \xrightarrow{(id,a)} b, \qquad a \xrightarrow{(id, a)}
  %c , \qquad a \xrightarrow{(id, a)} d \\
  a \xrightarrow{(id,a)\ (\equiv (id, b) \equiv (id,c) \equiv (id,d))} a, \qquad a
    \xrightarrow{(id,a)} b, \qquad a \xrightarrow{(id, a)} c , \qquad a \xrightarrow{(id, a)} d \\
  %b \xrightarrow{(id,b)} b \ (\equiv b \xrightarrow{(id, c)} b \equiv b \xrightarrow{(id, d)} b ),
  %\qquad b \xrightarrow{(id,b)} c, \qquad b \xrightarrow{(id,b)} d\\
  b \xrightarrow{(id,b) \ (\equiv (id, c) \equiv (id, d))} b , \qquad b \xrightarrow{(id,b)} c,
    \qquad b \xrightarrow{(id,b)} d\\
  c \xrightarrow{(id, c) \ (\equiv (id, d))} c ,   \qquad c \xrightarrow{(id,c)} d\\
  d \xrightarrow{(id,d)} d
\end{align*}
resulting in the straight-line ($a \to b \to c \to d$) lattice. The tensor in \D becomes the meet
and hence is a categorical product in $\widetilde{\D}$. Note that the only partial inverses in
$\widetilde{\D}$ are the identity functions and that for all maps $f$, $\<f,1\> = id$.

With the second tensor table, we have:
\begin{align*}
  a \xrightarrow{(id,a) \ (\equiv (id, b) \equiv (id,c) \equiv (id,d))} a, \qquad
    a \xrightarrow{(id,a)} b, \qquad a \xrightarrow{(id, a)} c , \qquad a \xrightarrow{(id, a)} d \\
  b \xrightarrow{(id,b) \ (\equiv (id, d))} b ,  \qquad b \xrightarrow{(id,b)} d\\
  c \xrightarrow{(id, c) \ (\equiv (id, d))} c,   \qquad c \xrightarrow{(id,c)} d\\
  d \xrightarrow{(id,d)} d
\end{align*}
resulting in the ``diamond'' lattice,
$
  \xymatrix @R=3pt @C=8pt {
    & b \ar[dr]\\
    a \ar[ur] \ar[dr] & &d\\
    & c \ar[ur]
  }
$. Once again, the tensor in \D is the meet.

\begin{example}{Lattice completion.}\label{example:lattice_completion}
  Suppose we have a set together with an idempotent, commutative, associative operation $\wedge$ on
  the set, giving us a lattice, \Lat. Further suppose the set is partially ordered via $\le$ with
  the order being compatible with $\wedge$.

  Then, we may create a pullback square for any $x' \le x,\ y' \le x$ with
  \[
    \xymatrix{
      &x\\
      x' \ar[ur]_{\le} & & y' \ar[ul]^{\le}\\
      &x'\wedge y'  \ar[ul]_{\le} \ar[ur]^{\le}
    }
  \]

  Considering \Lat as a category, we see that all maps are monic and therefore, we may create a
  partial map category $\text{Par}(\Lat,\Mstab)$ where the stable system of monics are all the maps.

  Then $\widetilde{\text{Par}(\Lat,\Mstab)}$ becomes the completion of the lattice over $\wedge$.
\end{example}
% subsection examples_of_the_wtf_construction (end)

\section{Inverse Turing Categories} % (fold)
\label{sec:inverse_turing_categories}

% section inverse_turing_categories (end)


\input{chapters/section/inverse-reversible}
% chapter inverse_categories (end)
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../phd-thesis"
%%% End:
