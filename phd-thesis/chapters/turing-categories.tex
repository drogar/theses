%!TEX root = /Users/gilesb/UofC/thesis/phd-thesis/phd-thesis.tex
\chapter{Turing Categories and PCAs} % (fold)
\label{chap:turing_categories}

In this chapter, we review the definition and properties of a Turing
category and Partial Combinatory
Algebras\cite{cockett-hostra08-intro-to-turing,cockett2010:categories-and-computability}. Because of
the theorems of the earlier chapters, we will be able to transfer these ideas in a straightforward
way from Cartesian restriction categories over to discrete inverse categories. We will show which
structures are needed in a discrete inverse category \X so that the constructed category, \Xt, is a
Turing category or has a PCA.

\section{Turing Categories}
\label{sec:turing_category_definitions}


\begin{definition}[Turing category]\label{def:turing_category}
  Given \X is a Cartesian restriction category:
  \begin{enumerate}
    \item For a map $\txy: A \times X \to Y$, a map $f:B\times X \to Y$ \emph{admits a $\txy$-index}
      when there is a total $\name{f}:B\to A$ such that
      \[
        \xymatrix@C+10pt@R+10pt{
          A\times X \ar[r]^{\txy} & Y \\
          B\times X \ar@{.>}[u]^{\name{f}\times 1_X} \ar[ur]_f
        }
      \]
      commutes.\label{defitem:turing_admit_txy_index}
    \item A map $\txy: A \times X \to Y$ is called a \emph{universal application} if all
      $f:B\times X \to Y$ admit a $\txy$-index.\label{defitem:turing_universal_application}
    \item If $A$ is an object in $\X$ such that for every pair of objects $X,Y$ in \X there is
      a universal application, then $A$ is called a \emph{Turing object}.
    \item A cartesian restriction category that contains a Turing object is called a
      \emph{Turing category}.
  \end{enumerate}
\end{definition}

Note there is no requirement in the definition for the map $\name{f}$ to be unique. When $\name{f}$ is unique
for a specific $\txy$, then that $\txy$ is called \emph{extensional}. In the case where the object
$B$ is the terminal object, then the map $\name{f}$ is a point of $A$ (with $f = (\name{f} \times 1)\txy$) and
$\name{f}$ is referred to as a \emph{code} of $f$.

\begin{definition}\label{def:turing_structure}
  Given $\T$ is a Turing category and $A$ is an object of \T,
  \begin{enumerate}
    \item If $\Upsilon=\{\txy: A\times X \to Y | X,Y \in ob(\T)\}$, then $\Upsilon$ is called an
      \emph{applicative family} for $A$.
    \item An applicative family $\Upsilon$ is called \emph{universal for $A$} when each $\txy$ is
      a universal application. This is also referred to as a \emph{Turing structure} on $A$.
    \item A pair $(A,\Upsilon)$ where $\Upsilon$ is universal for $A$ is called a \emph{Turing
      structure} on \T.
  \end{enumerate}
\end{definition}

\begin{lemma}\label{lem:turing_object_is_retractable}
  If \T is a Turing category with Turing object $T$, then every object $B$ in \T is a retract of
  $T$.
\end{lemma}
\begin{proof}
  As $T$ is a Turing object, we have a diagram for $\tur{1}{B}$ and $\pi_0:B\times 1 \to B$:
  \[
    \xymatrix@C+10pt@R+10pt{
      T\times 1 \ar[r]^{\tur{1}{B}} & B \\
      B\times 1. \ar@{.>}[u]^{\name{\pi_0}\times 1_1} \ar[ur]_{\pi_0}
    }
  \]
  Note we also have $u_r:B\to B\times 1$ is an
  isomorphism and therefore we have $1_X = u_r \pi_0 = (u_r (\name{\pi_0}\times 1)) \tur{1}{X}$. Hence, we
  have $((u_r (\name{\pi_0}\times 1)), \tur{1}{X}):B \retract T$.
\end{proof}

This allows for various recognition criteria for Turing categories.

\begin{theorem}\label{thm:turing_recognition}
  A Cartesian restriction category \D is a Turing category if and only if $\T$ has an object $T$
  for which every other object of \D is a retract and $T$ has a universal self-application map
  $\bullet$, written as $T\times T \xrightarrow{\ \bullet\ }T$.
\end{theorem}
\begin{proof}
  The ``only if'' portion follows immediately from setting $T$ to be the Turing object of $\D$ and
  $\bullet = \tur{T}{T}$.

  For the ``if'' direction, we need to construct the family of universal applications
  $\txy : T\times X \to Y$ for each pair of objects $X,Y$ in \D.

  Let us choose pairs of maps that witness the retractions of $X, Y$ of $T$, that is:
  \[
    (m_X,r_X):X \retract T \quad\text{and}\quad(m_Y,r_Y):Y \retract T.
  \]
  Define $\txy = (1_T\times m_X ) \bullet r_Y$. Suppose we are given $f:B\times X \to Y$. Consider
  \[
    \xymatrix@C+10pt@R+10pt{
      T \times X \ar[r]^{1_T\times m_X} & T\times T \ar[r]^{\bullet} & T \ar[r]^{r_Y} & Y \\
      B \times X \ar[r]^{1_B\times m_X} \ar[u]^{h\times 1_X}
        & B \times T \ar@{.>}[u]^{h\times 1_T} \ar[r]^{1_B \times r_X}
        & B \times X \ar[ur]^{f} \ar[u]^{f m_Y}
      }
  \]
  where $h$ is the index for the composite map $(1_B \times r_X) f m_Y$. The middle square commutes
  as $\bullet$ is a universal application for $T,T$. The right triangle commutes as $m_Y r_Y =1$.
  The left square commutes as each composite is $h \times m_X$. Noting that the bottom path from
  $B\times X$ to $Y$ is $(1_B \times m_X)(1_B \times r_X)f = f$ and the top path from $T\times X$ to
  $Y$ is our definition of $\txy$, this means $f$ admits the $\txy$-index $h$.
\end{proof}

Note that different splittings (choices of $(m,r)$ pairs) would lead to different $\txy$ maps. In
fact there is no requirement that this is the only way to create a universal applicative family
for $T$.

There is another criteria that also gives a Turing category:

\begin{lemma}\label{lem:t_t_to_t_gives_a_turing_category}
  A Cartesian restriction category \T is a Turing category if:
  \begin{enumerate}[{(}i{)}]
  \item $\T$ has an object $T$ for which every other object of \D is a retract;
  \item $T\times T$ has a map  $T\times T \xrightarrow{\ \circ\ }T$ and for all
    $f:T\to T$ there exists an element, $\code{f}:1\to T$ (which is total) such that
      \[
        \xymatrix{
          T\times T \ar[r]^{\circ} & T \\
          T \ar[ur]_{f} \ar[u]^{\<!\code{f},1\>}
        }
      \]
    is a commutative diagram.
  \end{enumerate}
\end{lemma}
\begin{proof}
  We need only show that $T$ has a universal self-application map and then use
  Theorem~\ref{thm:turing_recognition}.

  $T$ having a universal self-application map, $\bullet$, means for every map $f:B\times T \to T$ there is a
  map, $\name{f}:B\to T$ such that
  \[
    \xymatrix{
      T\times T \ar[r]^{\bullet} & T \\
      B\times T \ar[ur]_{f} \ar[u]^{\name{f}\times1}
    }
  \]
  commutes.

  Let $(m,r):T\times T\retract T$. Then, consider
  \[
    \xymatrix@C+15pt{
     T\times T \ar[r]^{r\times 1} & T\times T\times T \ar[r]^{1\times m} &T\times T \ar[rr]^{\circ}
       && T \\
     T\times T\times T \ar[u]^{m\times 1} \ar@{=}[ur]\\
     T\times T \ar@{.>}[u]^{\<\code{(rf)},\pi_0,\pi_1\>} \ar@{.>}[uur]_{\<\code{(rf)},\pi_0,\pi_1\>}
       \ar[rr]_{m} \ar@{=}@/_20pt/[rrr]
       & & T \ar[r]_{r} \ar@{.>}[uu]_{\<\code{(rf)},1\>} &T\times T. \ar[uur]_{f}
    }
  \]
  The rightmost quadrilateral commutes by assumption of this lemma. The middle quadrilateral
  commutes due to the properties of the product map and $\pi_0$ and $\pi_1$. The top left triangle
  commutes as $m r = 1$ and the remaining triangle has the same map on both dotted lines.

  Thus, we may conclude that $\bullet \definedas (r \times 1)(1\times m) \circ$ and
  $\name{f}\definedas \<!\code{f},1\> m$ satisfy the requirements of
  Theorem~\ref{thm:turing_recognition} and therefore $T$ is a Turing object in a Turing category.
\end{proof}
\section{Inverse Turing categories}
\label{sec:inverse_turing_categories}
Now, we define inverse Turing categories. Essentially, an inverse Turing category is a discrete
inverse category \X where $\Xt$ is a Turing category. Let us proceed with a more concrete
definition of this.

\begin{definition}\label{def:inverse_turing_category}
  A discrete inverse category \X is an \emph{inverse Turing category} when there is a universal object $T$ in
  \X with a map $\diamond :T\*T \to T\*T$ such that for every map $f:T \to T\*T$ there is a total map
  $\iname{f}: I\to T$ and a map $h_f:T\*T \to T\*T$ such that $f \xequiv{h_f}
  \inv{\usl}(\iname{f}\*1)\diamond$, i.e., the diagram
  \[
    \xymatrix @C=20pt @R=20pt{
      & & T \* T \ar@{.>}[dr]^{\Delta\* 1}\\
      &T\*T \ar[ur]^{\diamond} & & T \* (T\* T) \ar@{.>}[dd]^{1\*h_f}\\
      T \ar[ur]^{\inv{\usl}(\iname{f}\*1)} \ar[ddrr]_{f} \\
      & & & T \* T\*T \ar@{.>}[dl]^(.4){\inv{\Delta}\* 1}\\
      && T\*T
    }
  \]
  commutes.
\end{definition}

We know from Chapter~\ref{chap:completing_a_discrete_inverse_category} that when \X is an inverse
Turing category, that we know \Xt will be a discrete Cartesian restriction category. Moreover, if
$(m_A,r_A):A\retract T$ in \X, then $(m_A\inv{\usr},r_A\inv{\usr})A \retract T$ in \Xt and hence $T$
will remain universal in \Xt. Hence, we have the basic requirements for a Turing category as
specified in Theorem~\ref{thm:turing_recognition} and
Lemma~\ref{lem:t_t_to_t_gives_a_turing_category}. All that remains to be shown is that we have a
self-application map and a code for each map $f:1\to T$ as in Lemma~\ref{lem:t_t_to_t_gives_a_turing_category}.
\begin{theorem}\label{thm:inverse_turing_category_gives_a_turing_category}
  When $\X$ is an inverse Turing category, $\Xt$ is a Turing category.
\end{theorem}
\begin{proof}
  From the discussion, we need to specify the self-application map $\circ:T\times T \to T$ and
  $\code{f}:1 \to T$ in \Xt.

  The diagram of Definition~\ref{def:inverse_turing_category}, when raised to $\Xt$
  translates to:
  \[
    \xymatrix@C+25pt@R+10pt{
      T \times T \ar[r]^{(\diamond, T)} &T \\
      T. \ar[u]^{\<\iname{f},1\>} \ar[ur]_{(f, T)}
    }
  \]
  But this corresponds exactly to the requirement of
  Lemma~\ref{lem:t_t_to_t_gives_a_turing_category} with $\circ = (\diamond,T)$ and $\code{(f,T)} =
  \<\name{f},1\>$.  Finally, noting that $T$ is universal in \X, if we have $(f,B):T\to T$ in \Xt,
  where $(m_B,r_B):B\retract T$ in \X, we see $(f,B) \xequiv{} (fr_B,T)$ in \X and therefore may be
  written as above and we therefore have shown that $\Xt$ is a Turing category.
\end{proof}

\section{Partial combinatory algebras}
\label{sec:partial_combinatory_algebras}

\begin{notation}\label{not:multi-self-map}
  In a Cartesian restriction category, for any map $f:A\times A\to A$ define $\multiapp{f}{n}$
  recursively by:
  \begin{enumerate}[{(}i{)}]
  \item $\multiapp{f}{1} = f$
  \item $\multiapp{f}{n+1} = (f\times 1) \multiapp{f}{n}$
  \end{enumerate}
\end{notation}
\begin{definition}\label{def:partial_combinatory_algebra}
  A Cartesian restriction category has a \emph{partial combinatory algebra} when it has an object
  $A$ together with:
  \begin{enumerate}[{(}i{)}]
  \item A partial map $\bullet:A\times A \to A$,
  \item two total elements $1\xrightarrow{k}A$ and $1\xrightarrow{s}{A}$ which satisfy
    \[
      \xymatrix@C+25pt{
        A\times A\times A \ar[r]^(.6){(\bullet\times 1)\bullet} & A\\
        A\times A \ar[u]^{k\times1\times1} \ar[ur]_{\pi_1}
      }\quad
      \xymatrix{
        A\times A\times A\times A \ar[r]^(.6){\multibullet{3}}&A\\
        &A\times A \ar[u]_{\bullet}\\
        A\times A\times A \ar[uu]^{s\times1\times1\times1} \ar[r]_(.4){\theta_A'}
          & (A\times A) \times (A\times A) \ar[u]_{\bullet\times\bullet}
      }
    \]
    and $A\times A \xrightarrow{s\times1\times1} A\times A\times A \xrightarrow{\bullet^2} A$ is total.
  \end{enumerate}
  In the above $\theta' = (1\times1\times\Delta)(1\times c \times 1)a$ where $a$ sets the
  parenthesis as in the diagram.
\end{definition}

Of course, this is more familiarly given equationally:
\[
   (k\bullet x)\bullet y = x \qquad ((s\bullet x)\bullet y) \bullet z = (x\bullet z) \bullet
   (y\bullet z)
\]
which are the equations of a combinatory algebra where partiality is not considered. As we have
partiality, we want to consider when maps are total, thus we add the requirement that
$s\bullet x\bullet y$ is a
total map for any $x,y$.

Note that if we have a Turing object $T$ in a Cartesian restriction category, it is a partial
combinatory algebra. All we need to do is to actually define the element $k$ and $s$ by using the
commuting diagrams of Definition~\ref{def:partial_combinatory_algebra}.

Now, we want to consider what are the conditions required for an inverse category \X such that $\Xt$
has a partial combinatory algebra. First, we must alter the meaning of the notation
$\multiapp{f}{n}$ when in a discrete inverse category.

\begin{notation}\label{not:multi-self-map}
  In a discrete inverse category, for any map $f:A\* A\to A\*A$ where $A$ is a universal object
  (i.e., every object is a retract of $A$) define $\multiapp{f}{n}$
  recursively by:
  \begin{enumerate}[{(}i{)}]
  \item
    \[
       \raisebox{12pt}{$\multiapp{f}{1}:A\*A \to A\*A =f =\ $}
       \begin{tikzpicture}
         \node [style=nothing] (s1) at (0,1) {};
         \node [style=nothing] (s2) at (.5,1) {};
         \node [style=map] (bullet1) at (.25,.5) {$\scriptstyle f$};
         \node [style=nothing] (e1) at (0,0) {};
         \node [style=nothing] (e2) at (.5,0) {};
         \draw [] (s1) to[out=270,in=125] (bullet1);
         \draw [] (s2) to[out=270,in=55] (bullet1);
         \draw [] (bullet1) to[out=235,in=90] (e1);
         \draw [] (bullet1) to[out=305,in=90] (e2);
       \end{tikzpicture}
    \]
  \item
    \[
       \raisebox{35pt}{$\multiapp{f}{n+1}:\*_{n+2}A \to A\*A =\ $}
       \begin{tikzpicture}
         \node [style=nothing] (s1) at (0,2.5) {};
         \node [style=nothing] (s2) at (.5,2.5) {};
         \node [style=nothing] (s3) at (1,2.5) {};
         \node [style=map] (bullet1) at (.25,1.75) {$\scriptstyle \multiapp{f}{n}$};
         \node [style=map] (bullet2) at (.25,1) {$\scriptstyle f$};
         \node [style=retract] (r1) at (.5,.4) {};
         \node [style=nothing] (e1) at (0,0) {};
         \node [style=nothing] (e2) at (.5,0) {};
         \draw [] (s1) to[out=270,in=125] (bullet1);
         \draw [] (s2) to[out=270,in=55] (bullet1);
         \draw [] (s3) to[out=270,in=55] (bullet2);
         \draw [] (bullet1) to[out=235,in=125] (bullet2);
         \draw [] (bullet1) to[out=305,in=55] (r1);
         \draw [] (bullet2) to[out=305,in=125] (r1);
         \draw [] (bullet2) to[out=235,in=90] (e1);
         \draw [] (r1) to[out=270,in=90] (e2);
       \end{tikzpicture}
    \]
  \end{enumerate}
  In the above, the left pointing triangle, \begin{tikzpicture}\node [style=retract] at
    (0,0){};\end{tikzpicture}, signifies the section from $A\*A \to A$ such that $A\*A$ is a retract
  of $A$.
\end{notation}



\begin{definition}\label{def:inverse_partial_combinatory_algebra}
  A discrete inverse category \X has a \emph{inverse partial combinatory algebra} when there is a
  universal object $A$ in \X with a map $A\*A \xrightarrow{\bullet} A\*A$ and two total
  elements:
  \[
      1\xrightarrow{k}A \qquad 1\xrightarrow{s}{A}
  \]
  and maps
    $h_k:A\*A\to A\*A, h_s:A\*A\to A\*A$ which satisfy
    \[
      \xymatrix@C+15pt{
         && A\*A \ar@{.>}[dr]^{\Delta\*1}\\
        &A\* A\* A \ar[ur]^{\multibullet{2}} & & A\*A\*A\ar@{.>}[dd]^{1\*h_k}\\
        A\* A \ar[ur]^{\inv{\usl}(k\*1\*1)} \ar[ddrr]_{1} && &\\
         && & A\*A\*A \ar@{.>}[dl]^{\inv{\Delta}\*1}\\
        && A\*A &
      }
    \]
    i.e. $\inv{\usl}(k\*1\*1)\multibullet{2} \xequiv{h_k}1$ and
    \[
      \xymatrix{
        &&& A\* A \ar@{.>}[dr]^{\Delta\*1} \\
        & &  && A\* A\* A \ar@{.>}[dddd]^{1\*h_s}\\
        &A\* A\* A\* A
          \ar[uurr]^{\multibullet{3}}\\
        A\* A\* A \ar[ur]^{\inv{\usl}(s\*1)} \ar[dr]_(.4){\theta_A'}\\
        &(A\* A) \* (A\* A) \ar[dr]|{(\bullet\*\bullet)(1\*c\*1)(1\*1\*\retract)} \\
        & &A\* A\* A\ar[dr]_{(\bullet\*1)(1\*\retract)}& &A\*A\*A \ar@{.>}[dl]^{\inv{\Delta}\*1}\\
        &&&A\*A \\
      }
    \]
    i.e.,
    \[
      \inv{\usl}(s\*1)\multibullet{3} \xequiv{h_s}
      \theta_A'(\bullet\*\bullet)(1\*c\*1)(1\*1\*\retract)(\bullet\*1)(1\*\retract)
    \]
    and $I\*A\* A \xrightarrow{s\*1\*1} A\* A\* A \xrightarrow{\multibullet{2}} A\*A$ is total.
\end{definition}



% chapter turing_categories (end)

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../phd-thesis"
%%% End:
